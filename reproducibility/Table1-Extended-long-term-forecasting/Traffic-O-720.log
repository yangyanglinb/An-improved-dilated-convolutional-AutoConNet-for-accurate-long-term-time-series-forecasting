Args in experiment:
Namespace(AutoCon=True, AutoCon_lambda=1.0, AutoCon_multiscales=[96], AutoCon_wnorm='ReVIN', activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=1, checkpoints='./checkpoints/', d_ff=16, d_layers=1, d_model=16, data='traffic', data_path='traffic.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=3, embed='timeF', enc_in=1, factor=1, features='S', freq='h', gpu=0, is_training=1, itr=5, label_len=48, learning_rate=0.005, loss='MSE', lradj='type1', mask_rate=0.25, model='AutoConNet', model_id='ICLR24_CRV', moving_avg=25, n_heads=8, num_kernels=6, num_workers=2, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='./dataset/traffic', save=False, seasonal_patterns='Monthly', seq_len=336, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_ratio=0.6, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Autocorrelation calculation time: 1.4336
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConNet_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 3.6028390
	speed: 0.0509s/iter; left time: 69.8198s
Epoch: 1 cost time: 7.649646043777466
Epoch: 1, Steps: 147 Train Loss: 3.5735 (Forecasting Loss:0.1385 + AutoCon Loss:3.4351 x Lambda(1.0)), Vali MSE Loss: 0.1037 Test MSE Loss: 0.1809
Validation loss decreased (inf --> 0.103686).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 3.0655527
	speed: 0.0452s/iter; left time: 55.2697s
Epoch: 2 cost time: 6.374854326248169
Epoch: 2, Steps: 147 Train Loss: 3.1854 (Forecasting Loss:0.0825 + AutoCon Loss:3.1029 x Lambda(1.0)), Vali MSE Loss: 0.0965 Test MSE Loss: 0.1676
Validation loss decreased (0.103686 --> 0.096527).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 3.0418689
	speed: 0.0418s/iter; left time: 45.0044s
Epoch: 3 cost time: 6.00747013092041
Epoch: 3, Steps: 147 Train Loss: 3.0368 (Forecasting Loss:0.0745 + AutoCon Loss:2.9624 x Lambda(1.0)), Vali MSE Loss: 0.0874 Test MSE Loss: 0.1597
Validation loss decreased (0.096527 --> 0.087350).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 3.0029252
	speed: 0.0438s/iter; left time: 40.7169s
Epoch: 4 cost time: 6.122981786727905
Epoch: 4, Steps: 147 Train Loss: 3.0039 (Forecasting Loss:0.0703 + AutoCon Loss:2.9336 x Lambda(1.0)), Vali MSE Loss: 0.0838 Test MSE Loss: 0.1506
Validation loss decreased (0.087350 --> 0.083767).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 2.9821920
	speed: 0.0439s/iter; left time: 34.3640s
Epoch: 5 cost time: 7.056938409805298
Epoch: 5, Steps: 147 Train Loss: 2.9811 (Forecasting Loss:0.0680 + AutoCon Loss:2.9131 x Lambda(1.0)), Vali MSE Loss: 0.0808 Test MSE Loss: 0.1479
Validation loss decreased (0.083767 --> 0.080761).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 3.0275307
	speed: 0.0411s/iter; left time: 26.1560s
Epoch: 6 cost time: 6.318353176116943
Epoch: 6, Steps: 147 Train Loss: 2.9748 (Forecasting Loss:0.0670 + AutoCon Loss:2.9078 x Lambda(1.0)), Vali MSE Loss: 0.0803 Test MSE Loss: 0.1443
Validation loss decreased (0.080761 --> 0.080291).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 2.9930761
	speed: 0.0403s/iter; left time: 19.7136s
Epoch: 7 cost time: 6.056298017501831
Epoch: 7, Steps: 147 Train Loss: 2.9649 (Forecasting Loss:0.0664 + AutoCon Loss:2.8985 x Lambda(1.0)), Vali MSE Loss: 0.0794 Test MSE Loss: 0.1451
Validation loss decreased (0.080291 --> 0.079409).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 2.9824965
	speed: 0.0400s/iter; left time: 13.6940s
Epoch: 8 cost time: 6.04153037071228
Epoch: 8, Steps: 147 Train Loss: 2.9710 (Forecasting Loss:0.0660 + AutoCon Loss:2.9050 x Lambda(1.0)), Vali MSE Loss: 0.0793 Test MSE Loss: 0.1443
Validation loss decreased (0.079409 --> 0.079270).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 3.0455852
	speed: 0.0450s/iter; left time: 8.7845s
Epoch: 9 cost time: 7.328364133834839
Epoch: 9, Steps: 147 Train Loss: 2.9672 (Forecasting Loss:0.0659 + AutoCon Loss:2.9013 x Lambda(1.0)), Vali MSE Loss: 0.0790 Test MSE Loss: 0.1442
Validation loss decreased (0.079270 --> 0.078983).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 2.9555733
	speed: 0.0440s/iter; left time: 2.1119s
Epoch: 10 cost time: 6.417481899261475
Epoch: 10, Steps: 147 Train Loss: 2.9656 (Forecasting Loss:0.0658 + AutoCon Loss:2.8998 x Lambda(1.0)), Vali MSE Loss: 0.0789 Test MSE Loss: 0.1444
Validation loss decreased (0.078983 --> 0.078906).  Saving model ...
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConNet_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.1443919539451599, mae:0.225047305226326, mape:0.5557128190994263, mspe:25.762075424194336 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Autocorrelation calculation time: 1.4616
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConNet_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 3.5553465
	speed: 0.0403s/iter; left time: 55.2800s
Epoch: 1 cost time: 5.929598331451416
Epoch: 1, Steps: 147 Train Loss: 3.6078 (Forecasting Loss:0.1367 + AutoCon Loss:3.4710 x Lambda(1.0)), Vali MSE Loss: 0.1029 Test MSE Loss: 0.1765
Validation loss decreased (inf --> 0.102867).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 3.5046446
	speed: 0.0631s/iter; left time: 77.1937s
Epoch: 2 cost time: 8.091388702392578
Epoch: 2, Steps: 147 Train Loss: 3.5112 (Forecasting Loss:0.0826 + AutoCon Loss:3.4286 x Lambda(1.0)), Vali MSE Loss: 0.0981 Test MSE Loss: 0.1749
Validation loss decreased (0.102867 --> 0.098085).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 3.4509048
	speed: 0.0407s/iter; left time: 43.7894s
Epoch: 3 cost time: 5.930649757385254
Epoch: 3, Steps: 147 Train Loss: 3.4951 (Forecasting Loss:0.0743 + AutoCon Loss:3.4207 x Lambda(1.0)), Vali MSE Loss: 0.0880 Test MSE Loss: 0.1557
Validation loss decreased (0.098085 --> 0.088025).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 3.4791117
	speed: 0.0422s/iter; left time: 39.2640s
Epoch: 4 cost time: 6.105490684509277
Epoch: 4, Steps: 147 Train Loss: 3.4848 (Forecasting Loss:0.0707 + AutoCon Loss:3.4142 x Lambda(1.0)), Vali MSE Loss: 0.0832 Test MSE Loss: 0.1489
Validation loss decreased (0.088025 --> 0.083202).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 3.5738277
	speed: 0.0414s/iter; left time: 32.3997s
Epoch: 5 cost time: 6.305870056152344
Epoch: 5, Steps: 147 Train Loss: 3.4947 (Forecasting Loss:0.0689 + AutoCon Loss:3.4258 x Lambda(1.0)), Vali MSE Loss: 0.0812 Test MSE Loss: 0.1479
Validation loss decreased (0.083202 --> 0.081212).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 3.5191839
	speed: 0.0553s/iter; left time: 35.1945s
Epoch: 6 cost time: 7.516797780990601
Epoch: 6, Steps: 147 Train Loss: 3.4879 (Forecasting Loss:0.0679 + AutoCon Loss:3.4200 x Lambda(1.0)), Vali MSE Loss: 0.0802 Test MSE Loss: 0.1440
Validation loss decreased (0.081212 --> 0.080187).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 3.4348705
	speed: 0.0405s/iter; left time: 19.8101s
Epoch: 7 cost time: 5.845620632171631
Epoch: 7, Steps: 147 Train Loss: 3.4743 (Forecasting Loss:0.0674 + AutoCon Loss:3.4069 x Lambda(1.0)), Vali MSE Loss: 0.0796 Test MSE Loss: 0.1449
Validation loss decreased (0.080187 --> 0.079570).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 3.4714615
	speed: 0.0386s/iter; left time: 13.2029s
Epoch: 8 cost time: 5.894801616668701
Epoch: 8, Steps: 147 Train Loss: 3.4731 (Forecasting Loss:0.0671 + AutoCon Loss:3.4060 x Lambda(1.0)), Vali MSE Loss: 0.0792 Test MSE Loss: 0.1433
Validation loss decreased (0.079570 --> 0.079163).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 3.4892440
	speed: 0.0409s/iter; left time: 7.9658s
Epoch: 9 cost time: 6.008832931518555
Epoch: 9, Steps: 147 Train Loss: 3.4772 (Forecasting Loss:0.0668 + AutoCon Loss:3.4103 x Lambda(1.0)), Vali MSE Loss: 0.0790 Test MSE Loss: 0.1440
Validation loss decreased (0.079163 --> 0.078966).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 3.4580860
	speed: 0.0447s/iter; left time: 2.1472s
Epoch: 10 cost time: 7.2944395542144775
Epoch: 10, Steps: 147 Train Loss: 3.4864 (Forecasting Loss:0.0668 + AutoCon Loss:3.4196 x Lambda(1.0)), Vali MSE Loss: 0.0788 Test MSE Loss: 0.1440
Validation loss decreased (0.078966 --> 0.078834).  Saving model ...
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConNet_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14401422441005707, mae:0.22480563819408417, mape:0.5585349202156067, mspe:27.227386474609375 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Autocorrelation calculation time: 1.3789
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConNet_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 3.4352436
	speed: 0.0443s/iter; left time: 60.7971s
Epoch: 1 cost time: 6.2388153076171875
Epoch: 1, Steps: 147 Train Loss: 3.5918 (Forecasting Loss:0.1345 + AutoCon Loss:3.4573 x Lambda(1.0)), Vali MSE Loss: 0.1028 Test MSE Loss: 0.1765
Validation loss decreased (inf --> 0.102823).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 3.5891364
	speed: 0.0407s/iter; left time: 49.7785s
Epoch: 2 cost time: 5.815577745437622
Epoch: 2, Steps: 147 Train Loss: 3.4997 (Forecasting Loss:0.0829 + AutoCon Loss:3.4167 x Lambda(1.0)), Vali MSE Loss: 0.1003 Test MSE Loss: 0.1684
Validation loss decreased (0.102823 --> 0.100316).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 3.4457479
	speed: 0.0560s/iter; left time: 60.2923s
Epoch: 3 cost time: 7.5486674308776855
Epoch: 3, Steps: 147 Train Loss: 3.4843 (Forecasting Loss:0.0742 + AutoCon Loss:3.4101 x Lambda(1.0)), Vali MSE Loss: 0.0876 Test MSE Loss: 0.1542
Validation loss decreased (0.100316 --> 0.087602).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 3.5391347
	speed: 0.0397s/iter; left time: 36.9086s
Epoch: 4 cost time: 5.755568981170654
Epoch: 4, Steps: 147 Train Loss: 3.4749 (Forecasting Loss:0.0707 + AutoCon Loss:3.4042 x Lambda(1.0)), Vali MSE Loss: 0.0839 Test MSE Loss: 0.1476
Validation loss decreased (0.087602 --> 0.083876).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 3.4314828
	speed: 0.0437s/iter; left time: 34.2011s
Epoch: 5 cost time: 5.96770715713501
Epoch: 5, Steps: 147 Train Loss: 3.4270 (Forecasting Loss:0.0688 + AutoCon Loss:3.3581 x Lambda(1.0)), Vali MSE Loss: 0.0810 Test MSE Loss: 0.1468
Validation loss decreased (0.083876 --> 0.080979).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 3.3166311
	speed: 0.0358s/iter; left time: 22.7973s
Epoch: 6 cost time: 5.331813097000122
Epoch: 6, Steps: 147 Train Loss: 3.3338 (Forecasting Loss:0.0677 + AutoCon Loss:3.2661 x Lambda(1.0)), Vali MSE Loss: 0.0813 Test MSE Loss: 0.1477
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 3.3906806
	speed: 0.0439s/iter; left time: 21.4867s
Epoch: 7 cost time: 7.276794195175171
Epoch: 7, Steps: 147 Train Loss: 3.3169 (Forecasting Loss:0.0672 + AutoCon Loss:3.2497 x Lambda(1.0)), Vali MSE Loss: 0.0805 Test MSE Loss: 0.1436
Validation loss decreased (0.080979 --> 0.080543).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 3.1999660
	speed: 0.0401s/iter; left time: 13.6976s
Epoch: 8 cost time: 5.293740749359131
Epoch: 8, Steps: 147 Train Loss: 3.2867 (Forecasting Loss:0.0669 + AutoCon Loss:3.2198 x Lambda(1.0)), Vali MSE Loss: 0.0800 Test MSE Loss: 0.1448
Validation loss decreased (0.080543 --> 0.079965).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 3.2615557
	speed: 0.0454s/iter; left time: 8.8556s
Epoch: 9 cost time: 6.563539743423462
Epoch: 9, Steps: 147 Train Loss: 3.2773 (Forecasting Loss:0.0666 + AutoCon Loss:3.2107 x Lambda(1.0)), Vali MSE Loss: 0.0798 Test MSE Loss: 0.1446
Validation loss decreased (0.079965 --> 0.079810).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 3.2846813
	speed: 0.0473s/iter; left time: 2.2725s
Epoch: 10 cost time: 6.956475734710693
Epoch: 10, Steps: 147 Train Loss: 3.2861 (Forecasting Loss:0.0666 + AutoCon Loss:3.2195 x Lambda(1.0)), Vali MSE Loss: 0.0797 Test MSE Loss: 0.1446
Validation loss decreased (0.079810 --> 0.079667).  Saving model ...
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConNet_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.1445874124765396, mae:0.22554868459701538, mape:0.5590841174125671, mspe:27.442380905151367 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Autocorrelation calculation time: 1.4009
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConNet_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 3.4576354
	speed: 0.0413s/iter; left time: 56.6829s
Epoch: 1 cost time: 6.08443546295166
Epoch: 1, Steps: 147 Train Loss: 3.6104 (Forecasting Loss:0.1354 + AutoCon Loss:3.4750 x Lambda(1.0)), Vali MSE Loss: 0.1035 Test MSE Loss: 0.1760
Validation loss decreased (inf --> 0.103472).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 3.3478670
	speed: 0.0424s/iter; left time: 51.8731s
Epoch: 2 cost time: 6.204785108566284
Epoch: 2, Steps: 147 Train Loss: 3.3839 (Forecasting Loss:0.0827 + AutoCon Loss:3.3013 x Lambda(1.0)), Vali MSE Loss: 0.0956 Test MSE Loss: 0.1663
Validation loss decreased (0.103472 --> 0.095575).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 3.1276691
	speed: 0.0432s/iter; left time: 46.5060s
Epoch: 3 cost time: 6.020559072494507
Epoch: 3, Steps: 147 Train Loss: 3.1272 (Forecasting Loss:0.0740 + AutoCon Loss:3.0532 x Lambda(1.0)), Vali MSE Loss: 0.0883 Test MSE Loss: 0.1564
Validation loss decreased (0.095575 --> 0.088323).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 3.0654554
	speed: 0.0419s/iter; left time: 38.9676s
Epoch: 4 cost time: 6.228523015975952
Epoch: 4, Steps: 147 Train Loss: 3.0632 (Forecasting Loss:0.0704 + AutoCon Loss:2.9929 x Lambda(1.0)), Vali MSE Loss: 0.0845 Test MSE Loss: 0.1468
Validation loss decreased (0.088323 --> 0.084451).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 3.0582643
	speed: 0.0442s/iter; left time: 34.6177s
Epoch: 5 cost time: 6.470258474349976
Epoch: 5, Steps: 147 Train Loss: 3.0333 (Forecasting Loss:0.0681 + AutoCon Loss:2.9652 x Lambda(1.0)), Vali MSE Loss: 0.0824 Test MSE Loss: 0.1451
Validation loss decreased (0.084451 --> 0.082434).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 3.0549479
	speed: 0.0451s/iter; left time: 28.6861s
Epoch: 6 cost time: 6.696268558502197
Epoch: 6, Steps: 147 Train Loss: 3.0286 (Forecasting Loss:0.0670 + AutoCon Loss:2.9616 x Lambda(1.0)), Vali MSE Loss: 0.0807 Test MSE Loss: 0.1466
Validation loss decreased (0.082434 --> 0.080744).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 3.1038256
	speed: 0.0412s/iter; left time: 20.1381s
Epoch: 7 cost time: 6.265521764755249
Epoch: 7, Steps: 147 Train Loss: 3.0252 (Forecasting Loss:0.0664 + AutoCon Loss:2.9587 x Lambda(1.0)), Vali MSE Loss: 0.0801 Test MSE Loss: 0.1457
Validation loss decreased (0.080744 --> 0.080102).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 3.0838666
	speed: 0.0459s/iter; left time: 15.7019s
Epoch: 8 cost time: 6.394877672195435
Epoch: 8, Steps: 147 Train Loss: 3.0194 (Forecasting Loss:0.0661 + AutoCon Loss:2.9533 x Lambda(1.0)), Vali MSE Loss: 0.0793 Test MSE Loss: 0.1442
Validation loss decreased (0.080102 --> 0.079284).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 3.0434966
	speed: 0.0484s/iter; left time: 9.4443s
Epoch: 9 cost time: 6.926002264022827
Epoch: 9, Steps: 147 Train Loss: 3.0244 (Forecasting Loss:0.0659 + AutoCon Loss:2.9585 x Lambda(1.0)), Vali MSE Loss: 0.0792 Test MSE Loss: 0.1442
Validation loss decreased (0.079284 --> 0.079219).  Saving model ...
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 3.0519891
	speed: 0.0428s/iter; left time: 2.0567s
Epoch: 10 cost time: 6.156377553939819
Epoch: 10, Steps: 147 Train Loss: 3.0210 (Forecasting Loss:0.0658 + AutoCon Loss:2.9553 x Lambda(1.0)), Vali MSE Loss: 0.0792 Test MSE Loss: 0.1451
Validation loss decreased (0.079219 --> 0.079162).  Saving model ...
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConNet_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.145075723528862, mae:0.22539778053760529, mape:0.5600144863128662, mspe:27.610605239868164 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:492225
train 9471
Auto-correlation values(abs):[1.        0.9951944] ~ [-0.00925182 -0.00461993]
Autocorrelation calculation time: 1.3892
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConNet_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 9471
val 2791
test 2789
	iters: 100, epoch: 1 | loss: 3.6432028
	speed: 0.0469s/iter; left time: 64.2376s
Epoch: 1 cost time: 7.46685266494751
Epoch: 1, Steps: 147 Train Loss: 3.6337 (Forecasting Loss:0.1373 + AutoCon Loss:3.4964 x Lambda(1.0)), Vali MSE Loss: 0.1032 Test MSE Loss: 0.1765
Validation loss decreased (inf --> 0.103232).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 2 | loss: 3.5507729
	speed: 0.0408s/iter; left time: 49.9006s
Epoch: 2 cost time: 5.783125162124634
Epoch: 2, Steps: 147 Train Loss: 3.5197 (Forecasting Loss:0.0827 + AutoCon Loss:3.4370 x Lambda(1.0)), Vali MSE Loss: 0.0956 Test MSE Loss: 0.1671
Validation loss decreased (0.103232 --> 0.095552).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 3 | loss: 3.4404309
	speed: 0.0450s/iter; left time: 48.4196s
Epoch: 3 cost time: 6.518468141555786
Epoch: 3, Steps: 147 Train Loss: 3.4553 (Forecasting Loss:0.0745 + AutoCon Loss:3.3808 x Lambda(1.0)), Vali MSE Loss: 0.0892 Test MSE Loss: 0.1584
Validation loss decreased (0.095552 --> 0.089204).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 4 | loss: 3.2162204
	speed: 0.0470s/iter; left time: 43.7360s
Epoch: 4 cost time: 6.4911627769470215
Epoch: 4, Steps: 147 Train Loss: 3.2865 (Forecasting Loss:0.0706 + AutoCon Loss:3.2159 x Lambda(1.0)), Vali MSE Loss: 0.0826 Test MSE Loss: 0.1505
Validation loss decreased (0.089204 --> 0.082567).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 5 | loss: 3.2048905
	speed: 0.0468s/iter; left time: 36.6220s
Epoch: 5 cost time: 7.28659200668335
Epoch: 5, Steps: 147 Train Loss: 3.2511 (Forecasting Loss:0.0686 + AutoCon Loss:3.1825 x Lambda(1.0)), Vali MSE Loss: 0.0811 Test MSE Loss: 0.1470
Validation loss decreased (0.082567 --> 0.081141).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 6 | loss: 3.2198393
	speed: 0.0402s/iter; left time: 25.5771s
Epoch: 6 cost time: 5.91575813293457
Epoch: 6, Steps: 147 Train Loss: 3.2168 (Forecasting Loss:0.0677 + AutoCon Loss:3.1491 x Lambda(1.0)), Vali MSE Loss: 0.0806 Test MSE Loss: 0.1465
Validation loss decreased (0.081141 --> 0.080615).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 7 | loss: 3.2269886
	speed: 0.0445s/iter; left time: 21.7824s
Epoch: 7 cost time: 6.404777765274048
Epoch: 7, Steps: 147 Train Loss: 3.1973 (Forecasting Loss:0.0670 + AutoCon Loss:3.1303 x Lambda(1.0)), Vali MSE Loss: 0.0800 Test MSE Loss: 0.1446
Validation loss decreased (0.080615 --> 0.079989).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 8 | loss: 3.2711575
	speed: 0.0433s/iter; left time: 14.8042s
Epoch: 8 cost time: 6.224145412445068
Epoch: 8, Steps: 147 Train Loss: 3.1903 (Forecasting Loss:0.0666 + AutoCon Loss:3.1237 x Lambda(1.0)), Vali MSE Loss: 0.0803 Test MSE Loss: 0.1443
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 9 | loss: 3.1494870
	speed: 0.0455s/iter; left time: 8.8643s
Epoch: 9 cost time: 7.392139911651611
Epoch: 9, Steps: 147 Train Loss: 3.1809 (Forecasting Loss:0.0665 + AutoCon Loss:3.1144 x Lambda(1.0)), Vali MSE Loss: 0.0800 Test MSE Loss: 0.1444
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 10 | loss: 3.2099926
	speed: 0.0428s/iter; left time: 2.0553s
Epoch: 10 cost time: 6.149964332580566
Epoch: 10, Steps: 147 Train Loss: 3.1800 (Forecasting Loss:0.0664 + AutoCon Loss:3.1136 x Lambda(1.0)), Vali MSE Loss: 0.0799 Test MSE Loss: 0.1445
Validation loss decreased (0.079989 --> 0.079872).  Saving model ...
Updating learning rate to 9.765625e-06
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConNet_traffic_ftS_sl336_ll48_pl720_dm16_nh8_el3_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (43, 64, 720, 1) (43, 64, 720, 1)
test shape: (2752, 720, 1) (2752, 720, 1)
mse:0.14445525407791138, mae:0.22492223978042603, mape:0.5571843385696411, mspe:26.326990127563477 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.1445+-0.00048, MAE:0.2251+-0.00039, MAPE:0.5581+-0.00209, MSPE:26.8739+-0.98674, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000