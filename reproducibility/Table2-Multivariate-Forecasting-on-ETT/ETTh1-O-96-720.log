Args in experiment:
Namespace(AutoCon=True, AutoCon_lambda=1.0, AutoCon_multiscales=[96], AutoCon_wnorm='LastVal', activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=7, checkpoints='./checkpoints/', d_ff=16, d_layers=1, d_model=16, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=7, factor=1, features='M', freq='h', gpu=0, is_training=1, itr=5, label_len=48, learning_rate=0.01, loss='MSE', lradj='type1', mask_rate=0.25, model='AutoConCI', model_id='ICLR24_CRV', moving_avg=25, n_heads=8, num_kernels=6, num_workers=2, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='./dataset/ETT-small', save=False, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_ratio=0.6, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:24001
train 8449
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.1314
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 3.6557264
	speed: 0.0290s/iter; left time: 35.3566s
Epoch: 1 cost time: 3.7874016761779785
Epoch: 1, Steps: 132 Train Loss: 3.7337 (Forecasting Loss:0.4016 + AutoCon Loss:3.3320 x Lambda(1.0)), Vali MSE Loss: 0.7139 Test MSE Loss: 0.4040
Validation loss decreased (inf --> 0.713870).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.9033735
	speed: 0.0293s/iter; left time: 31.9375s
Epoch: 2 cost time: 3.822317123413086
Epoch: 2, Steps: 132 Train Loss: 3.7068 (Forecasting Loss:0.3726 + AutoCon Loss:3.3342 x Lambda(1.0)), Vali MSE Loss: 0.7733 Test MSE Loss: 0.4077
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.7282057
	speed: 0.0272s/iter; left time: 26.0334s
Epoch: 3 cost time: 3.5737972259521484
Epoch: 3, Steps: 132 Train Loss: 3.6791 (Forecasting Loss:0.3608 + AutoCon Loss:3.3183 x Lambda(1.0)), Vali MSE Loss: 0.7116 Test MSE Loss: 0.3852
Validation loss decreased (0.713870 --> 0.711631).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.7923546
	speed: 0.0275s/iter; left time: 22.6913s
Epoch: 4 cost time: 3.580203056335449
Epoch: 4, Steps: 132 Train Loss: 3.6988 (Forecasting Loss:0.3568 + AutoCon Loss:3.3420 x Lambda(1.0)), Vali MSE Loss: 0.6958 Test MSE Loss: 0.3899
Validation loss decreased (0.711631 --> 0.695800).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.6690431
	speed: 0.0276s/iter; left time: 19.1081s
Epoch: 5 cost time: 3.597670555114746
Epoch: 5, Steps: 132 Train Loss: 3.6715 (Forecasting Loss:0.3553 + AutoCon Loss:3.3162 x Lambda(1.0)), Vali MSE Loss: 0.6991 Test MSE Loss: 0.3845
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.6770990
	speed: 0.0272s/iter; left time: 15.2529s
Epoch: 6 cost time: 3.5546722412109375
Epoch: 6, Steps: 132 Train Loss: 3.6902 (Forecasting Loss:0.3540 + AutoCon Loss:3.3363 x Lambda(1.0)), Vali MSE Loss: 0.6988 Test MSE Loss: 0.3845
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.7301416
	speed: 0.0287s/iter; left time: 12.3070s
Epoch: 7 cost time: 3.8862218856811523
Epoch: 7, Steps: 132 Train Loss: 3.6889 (Forecasting Loss:0.3533 + AutoCon Loss:3.3356 x Lambda(1.0)), Vali MSE Loss: 0.6995 Test MSE Loss: 0.3832
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (43, 64, 96, 7) (43, 64, 96, 7)
test shape: (2752, 96, 7) (2752, 96, 7)
mse:0.38987451791763306, mae:0.39802438020706177, mape:9.620537757873535, mspe:45536.35546875 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:24001
train 8449
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0479
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 3.6167829
	speed: 0.0274s/iter; left time: 33.4757s
Epoch: 1 cost time: 3.631244659423828
Epoch: 1, Steps: 132 Train Loss: 3.6943 (Forecasting Loss:0.4030 + AutoCon Loss:3.2913 x Lambda(1.0)), Vali MSE Loss: 0.7155 Test MSE Loss: 0.4024
Validation loss decreased (inf --> 0.715463).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.6047866
	speed: 0.0286s/iter; left time: 31.1643s
Epoch: 2 cost time: 3.7441391944885254
Epoch: 2, Steps: 132 Train Loss: 3.6719 (Forecasting Loss:0.3684 + AutoCon Loss:3.3035 x Lambda(1.0)), Vali MSE Loss: 0.7300 Test MSE Loss: 0.3979
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.6683972
	speed: 0.0271s/iter; left time: 25.9615s
Epoch: 3 cost time: 3.5525875091552734
Epoch: 3, Steps: 132 Train Loss: 3.6391 (Forecasting Loss:0.3609 + AutoCon Loss:3.2781 x Lambda(1.0)), Vali MSE Loss: 0.6965 Test MSE Loss: 0.3922
Validation loss decreased (0.715463 --> 0.696513).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.8139217
	speed: 0.0277s/iter; left time: 22.8356s
Epoch: 4 cost time: 3.6404178142547607
Epoch: 4, Steps: 132 Train Loss: 3.6501 (Forecasting Loss:0.3564 + AutoCon Loss:3.2937 x Lambda(1.0)), Vali MSE Loss: 0.6946 Test MSE Loss: 0.3878
Validation loss decreased (0.696513 --> 0.694581).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.6250103
	speed: 0.0281s/iter; left time: 19.5027s
Epoch: 5 cost time: 3.648322105407715
Epoch: 5, Steps: 132 Train Loss: 3.6239 (Forecasting Loss:0.3543 + AutoCon Loss:3.2696 x Lambda(1.0)), Vali MSE Loss: 0.6977 Test MSE Loss: 0.3827
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.7024801
	speed: 0.0284s/iter; left time: 15.9370s
Epoch: 6 cost time: 3.701707124710083
Epoch: 6, Steps: 132 Train Loss: 3.6523 (Forecasting Loss:0.3534 + AutoCon Loss:3.2989 x Lambda(1.0)), Vali MSE Loss: 0.6974 Test MSE Loss: 0.3832
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.6956265
	speed: 0.0275s/iter; left time: 11.8078s
Epoch: 7 cost time: 3.620534658432007
Epoch: 7, Steps: 132 Train Loss: 3.6550 (Forecasting Loss:0.3525 + AutoCon Loss:3.3025 x Lambda(1.0)), Vali MSE Loss: 0.6935 Test MSE Loss: 0.3833
Validation loss decreased (0.694581 --> 0.693454).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.6507092
	speed: 0.0293s/iter; left time: 8.7005s
Epoch: 8 cost time: 3.922640800476074
Epoch: 8, Steps: 132 Train Loss: 3.6448 (Forecasting Loss:0.3521 + AutoCon Loss:3.2927 x Lambda(1.0)), Vali MSE Loss: 0.6972 Test MSE Loss: 0.3826
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.6815059
	speed: 0.0285s/iter; left time: 4.7006s
Epoch: 9 cost time: 3.7669899463653564
Epoch: 9, Steps: 132 Train Loss: 3.6408 (Forecasting Loss:0.3518 + AutoCon Loss:3.2890 x Lambda(1.0)), Vali MSE Loss: 0.6988 Test MSE Loss: 0.3825
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 3.5540679
	speed: 0.0295s/iter; left time: 0.9723s
Epoch: 10 cost time: 3.8823461532592773
Epoch: 10, Steps: 132 Train Loss: 3.6354 (Forecasting Loss:0.3517 + AutoCon Loss:3.2837 x Lambda(1.0)), Vali MSE Loss: 0.6973 Test MSE Loss: 0.3823
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (43, 64, 96, 7) (43, 64, 96, 7)
test shape: (2752, 96, 7) (2752, 96, 7)
mse:0.3832811415195465, mae:0.39256709814071655, mape:9.394880294799805, mspe:43921.24609375 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:24001
train 8449
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0474
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 3.6342525
	speed: 0.0282s/iter; left time: 34.4245s
Epoch: 1 cost time: 3.6679022312164307
Epoch: 1, Steps: 132 Train Loss: 3.7215 (Forecasting Loss:0.4031 + AutoCon Loss:3.3185 x Lambda(1.0)), Vali MSE Loss: 0.7029 Test MSE Loss: 0.4044
Validation loss decreased (inf --> 0.702880).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.6990869
	speed: 0.0278s/iter; left time: 30.3151s
Epoch: 2 cost time: 3.8874588012695312
Epoch: 2, Steps: 132 Train Loss: 3.7196 (Forecasting Loss:0.3681 + AutoCon Loss:3.3516 x Lambda(1.0)), Vali MSE Loss: 0.7131 Test MSE Loss: 0.4001
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.7511551
	speed: 0.0274s/iter; left time: 26.2387s
Epoch: 3 cost time: 3.666201591491699
Epoch: 3, Steps: 132 Train Loss: 3.7007 (Forecasting Loss:0.3603 + AutoCon Loss:3.3404 x Lambda(1.0)), Vali MSE Loss: 0.7035 Test MSE Loss: 0.3943
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.6370702
	speed: 0.0295s/iter; left time: 24.3634s
Epoch: 4 cost time: 4.046228408813477
Epoch: 4, Steps: 132 Train Loss: 3.6874 (Forecasting Loss:0.3564 + AutoCon Loss:3.3311 x Lambda(1.0)), Vali MSE Loss: 0.7087 Test MSE Loss: 0.3848
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (43, 64, 96, 7) (43, 64, 96, 7)
test shape: (2752, 96, 7) (2752, 96, 7)
mse:0.4044269323348999, mae:0.4099655747413635, mape:9.669892311096191, mspe:46070.00390625 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:24001
train 8449
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0488
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 3.6800122
	speed: 0.0277s/iter; left time: 33.8677s
Epoch: 1 cost time: 3.653627634048462
Epoch: 1, Steps: 132 Train Loss: 3.7187 (Forecasting Loss:0.4165 + AutoCon Loss:3.3022 x Lambda(1.0)), Vali MSE Loss: 0.7213 Test MSE Loss: 0.4112
Validation loss decreased (inf --> 0.721253).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.6117697
	speed: 0.0276s/iter; left time: 30.0076s
Epoch: 2 cost time: 3.596557855606079
Epoch: 2, Steps: 132 Train Loss: 3.7101 (Forecasting Loss:0.3683 + AutoCon Loss:3.3419 x Lambda(1.0)), Vali MSE Loss: 0.7153 Test MSE Loss: 0.3950
Validation loss decreased (0.721253 --> 0.715264).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.6904469
	speed: 0.0283s/iter; left time: 27.1099s
Epoch: 3 cost time: 3.6848394870758057
Epoch: 3, Steps: 132 Train Loss: 3.7040 (Forecasting Loss:0.3602 + AutoCon Loss:3.3438 x Lambda(1.0)), Vali MSE Loss: 0.7045 Test MSE Loss: 0.3948
Validation loss decreased (0.715264 --> 0.704548).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.6651981
	speed: 0.0287s/iter; left time: 23.6367s
Epoch: 4 cost time: 3.703237533569336
Epoch: 4, Steps: 132 Train Loss: 3.7076 (Forecasting Loss:0.3568 + AutoCon Loss:3.3508 x Lambda(1.0)), Vali MSE Loss: 0.7026 Test MSE Loss: 0.3862
Validation loss decreased (0.704548 --> 0.702612).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.7138119
	speed: 0.0280s/iter; left time: 19.3755s
Epoch: 5 cost time: 3.6488828659057617
Epoch: 5, Steps: 132 Train Loss: 3.6897 (Forecasting Loss:0.3553 + AutoCon Loss:3.3344 x Lambda(1.0)), Vali MSE Loss: 0.7071 Test MSE Loss: 0.3849
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.7038591
	speed: 0.0276s/iter; left time: 15.4857s
Epoch: 6 cost time: 3.578141212463379
Epoch: 6, Steps: 132 Train Loss: 3.6798 (Forecasting Loss:0.3543 + AutoCon Loss:3.3255 x Lambda(1.0)), Vali MSE Loss: 0.6983 Test MSE Loss: 0.3847
Validation loss decreased (0.702612 --> 0.698253).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.6694531
	speed: 0.0276s/iter; left time: 11.8214s
Epoch: 7 cost time: 3.607299566268921
Epoch: 7, Steps: 132 Train Loss: 3.6729 (Forecasting Loss:0.3537 + AutoCon Loss:3.3192 x Lambda(1.0)), Vali MSE Loss: 0.6960 Test MSE Loss: 0.3841
Validation loss decreased (0.698253 --> 0.695960).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.6591876
	speed: 0.0269s/iter; left time: 8.0031s
Epoch: 8 cost time: 3.6380999088287354
Epoch: 8, Steps: 132 Train Loss: 3.6698 (Forecasting Loss:0.3533 + AutoCon Loss:3.3166 x Lambda(1.0)), Vali MSE Loss: 0.7000 Test MSE Loss: 0.3831
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.6586301
	speed: 0.0285s/iter; left time: 4.7001s
Epoch: 9 cost time: 3.713911771774292
Epoch: 9, Steps: 132 Train Loss: 3.6676 (Forecasting Loss:0.3531 + AutoCon Loss:3.3145 x Lambda(1.0)), Vali MSE Loss: 0.6986 Test MSE Loss: 0.3834
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 3.6763432
	speed: 0.0283s/iter; left time: 0.9336s
Epoch: 10 cost time: 3.698195457458496
Epoch: 10, Steps: 132 Train Loss: 3.6702 (Forecasting Loss:0.3529 + AutoCon Loss:3.3172 x Lambda(1.0)), Vali MSE Loss: 0.6977 Test MSE Loss: 0.3833
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (43, 64, 96, 7) (43, 64, 96, 7)
test shape: (2752, 96, 7) (2752, 96, 7)
mse:0.3840532898902893, mae:0.39308908581733704, mape:9.448759078979492, mspe:44426.33984375 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:24001
train 8449
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0455
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 3.5494401
	speed: 0.0279s/iter; left time: 34.0768s
Epoch: 1 cost time: 3.6579599380493164
Epoch: 1, Steps: 132 Train Loss: 3.6413 (Forecasting Loss:0.4043 + AutoCon Loss:3.2370 x Lambda(1.0)), Vali MSE Loss: 0.7080 Test MSE Loss: 0.4057
Validation loss decreased (inf --> 0.708013).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.7888229
	speed: 0.0278s/iter; left time: 30.2862s
Epoch: 2 cost time: 3.6580090522766113
Epoch: 2, Steps: 132 Train Loss: 3.7166 (Forecasting Loss:0.3669 + AutoCon Loss:3.3497 x Lambda(1.0)), Vali MSE Loss: 0.7139 Test MSE Loss: 0.4007
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.7817416
	speed: 0.0282s/iter; left time: 27.0193s
Epoch: 3 cost time: 3.7148492336273193
Epoch: 3, Steps: 132 Train Loss: 3.8253 (Forecasting Loss:0.3615 + AutoCon Loss:3.4638 x Lambda(1.0)), Vali MSE Loss: 0.7230 Test MSE Loss: 0.3915
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.8655400
	speed: 0.0281s/iter; left time: 23.1665s
Epoch: 4 cost time: 3.6666905879974365
Epoch: 4, Steps: 132 Train Loss: 3.7716 (Forecasting Loss:0.3571 + AutoCon Loss:3.4145 x Lambda(1.0)), Vali MSE Loss: 0.7006 Test MSE Loss: 0.3918
Validation loss decreased (0.708013 --> 0.700622).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.7876928
	speed: 0.0285s/iter; left time: 19.7540s
Epoch: 5 cost time: 3.7767603397369385
Epoch: 5, Steps: 132 Train Loss: 3.7685 (Forecasting Loss:0.3560 + AutoCon Loss:3.4125 x Lambda(1.0)), Vali MSE Loss: 0.7152 Test MSE Loss: 0.3855
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.9053493
	speed: 0.0296s/iter; left time: 16.5965s
Epoch: 6 cost time: 3.7891628742218018
Epoch: 6, Steps: 132 Train Loss: 3.7676 (Forecasting Loss:0.3549 + AutoCon Loss:3.4128 x Lambda(1.0)), Vali MSE Loss: 0.6987 Test MSE Loss: 0.3843
Validation loss decreased (0.700622 --> 0.698650).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.7876031
	speed: 0.0287s/iter; left time: 12.3275s
Epoch: 7 cost time: 3.7305145263671875
Epoch: 7, Steps: 132 Train Loss: 3.7592 (Forecasting Loss:0.3537 + AutoCon Loss:3.4055 x Lambda(1.0)), Vali MSE Loss: 0.6961 Test MSE Loss: 0.3848
Validation loss decreased (0.698650 --> 0.696108).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.7766197
	speed: 0.0283s/iter; left time: 8.3920s
Epoch: 8 cost time: 3.683713674545288
Epoch: 8, Steps: 132 Train Loss: 3.7529 (Forecasting Loss:0.3533 + AutoCon Loss:3.3996 x Lambda(1.0)), Vali MSE Loss: 0.6962 Test MSE Loss: 0.3846
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.7406013
	speed: 0.0280s/iter; left time: 4.6259s
Epoch: 9 cost time: 3.6856110095977783
Epoch: 9, Steps: 132 Train Loss: 3.7638 (Forecasting Loss:0.3532 + AutoCon Loss:3.4106 x Lambda(1.0)), Vali MSE Loss: 0.6966 Test MSE Loss: 0.3843
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 3.7694426
	speed: 0.0283s/iter; left time: 0.9335s
Epoch: 10 cost time: 3.717686176300049
Epoch: 10, Steps: 132 Train Loss: 3.7581 (Forecasting Loss:0.3529 + AutoCon Loss:3.4052 x Lambda(1.0)), Vali MSE Loss: 0.6996 Test MSE Loss: 0.3835
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (43, 64, 96, 7) (43, 64, 96, 7)
test shape: (2752, 96, 7) (2752, 96, 7)
mse:0.3848051130771637, mae:0.39369282126426697, mape:9.440284729003906, mspe:44036.375 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.3893+-0.01099, MAE:0.3975+-0.00908, MAPE:9.5149+-0.15147, MSPE:44798.0664+-1186.10825, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(AutoCon=True, AutoCon_lambda=1.0, AutoCon_multiscales=[192], AutoCon_wnorm='LastVal', activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=7, checkpoints='./checkpoints/', d_ff=16, d_layers=1, d_model=16, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=1, embed='timeF', enc_in=7, factor=1, features='M', freq='h', gpu=0, is_training=1, itr=5, label_len=48, learning_rate=0.01, loss='MSE', lradj='type1', mask_rate=0.25, model='AutoConCI', model_id='ICLR24_CRV', moving_avg=25, n_heads=8, num_kernels=6, num_workers=2, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='./dataset/ETT-small', save=False, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_ratio=0.6, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:41057
train 8353
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.1257
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl192_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 3.7998586
	speed: 0.0296s/iter; left time: 35.5206s
Epoch: 1 cost time: 3.8130342960357666
Epoch: 1, Steps: 130 Train Loss: 3.7966 (Forecasting Loss:0.4697 + AutoCon Loss:3.3269 x Lambda(1.0)), Vali MSE Loss: 1.0048 Test MSE Loss: 0.4609
Validation loss decreased (inf --> 1.004757).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.7759950
	speed: 0.0300s/iter; left time: 32.1618s
Epoch: 2 cost time: 3.8409030437469482
Epoch: 2, Steps: 130 Train Loss: 3.7705 (Forecasting Loss:0.4334 + AutoCon Loss:3.3370 x Lambda(1.0)), Vali MSE Loss: 1.0164 Test MSE Loss: 0.4487
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.6711929
	speed: 0.0292s/iter; left time: 27.4392s
Epoch: 3 cost time: 3.8590869903564453
Epoch: 3, Steps: 130 Train Loss: 3.7677 (Forecasting Loss:0.4261 + AutoCon Loss:3.3416 x Lambda(1.0)), Vali MSE Loss: 1.0093 Test MSE Loss: 0.4451
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.7322571
	speed: 0.0302s/iter; left time: 24.4629s
Epoch: 4 cost time: 3.9096391201019287
Epoch: 4, Steps: 130 Train Loss: 3.7288 (Forecasting Loss:0.4211 + AutoCon Loss:3.3077 x Lambda(1.0)), Vali MSE Loss: 1.0009 Test MSE Loss: 0.4365
Validation loss decreased (1.004757 --> 1.000878).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.7417288
	speed: 0.0299s/iter; left time: 20.3282s
Epoch: 5 cost time: 3.819166660308838
Epoch: 5, Steps: 130 Train Loss: 3.7365 (Forecasting Loss:0.4198 + AutoCon Loss:3.3167 x Lambda(1.0)), Vali MSE Loss: 0.9996 Test MSE Loss: 0.4357
Validation loss decreased (1.000878 --> 0.999555).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.7654972
	speed: 0.0311s/iter; left time: 17.1499s
Epoch: 6 cost time: 4.044503450393677
Epoch: 6, Steps: 130 Train Loss: 3.7379 (Forecasting Loss:0.4184 + AutoCon Loss:3.3195 x Lambda(1.0)), Vali MSE Loss: 0.9960 Test MSE Loss: 0.4345
Validation loss decreased (0.999555 --> 0.995978).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.6872919
	speed: 0.0291s/iter; left time: 12.2681s
Epoch: 7 cost time: 3.7918648719787598
Epoch: 7, Steps: 130 Train Loss: 3.7427 (Forecasting Loss:0.4173 + AutoCon Loss:3.3255 x Lambda(1.0)), Vali MSE Loss: 0.9961 Test MSE Loss: 0.4332
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.7540298
	speed: 0.0309s/iter; left time: 8.9782s
Epoch: 8 cost time: 3.935119152069092
Epoch: 8, Steps: 130 Train Loss: 3.7386 (Forecasting Loss:0.4173 + AutoCon Loss:3.3213 x Lambda(1.0)), Vali MSE Loss: 0.9913 Test MSE Loss: 0.4355
Validation loss decreased (0.995978 --> 0.991295).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.7570181
	speed: 0.0303s/iter; left time: 4.8773s
Epoch: 9 cost time: 3.9405972957611084
Epoch: 9, Steps: 130 Train Loss: 3.7306 (Forecasting Loss:0.4172 + AutoCon Loss:3.3134 x Lambda(1.0)), Vali MSE Loss: 0.9961 Test MSE Loss: 0.4331
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 3.7413919
	speed: 0.0303s/iter; left time: 0.9395s
Epoch: 10 cost time: 3.978755235671997
Epoch: 10, Steps: 130 Train Loss: 3.7283 (Forecasting Loss:0.4170 + AutoCon Loss:3.3113 x Lambda(1.0)), Vali MSE Loss: 0.9954 Test MSE Loss: 0.4333
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-05
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl192_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (42, 64, 192, 7) (42, 64, 192, 7)
test shape: (2688, 192, 7) (2688, 192, 7)
mse:0.4354917109012604, mae:0.42253363132476807, mape:9.576532363891602, mspe:40079.9140625 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:41057
train 8353
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0478
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl192_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 3.7366462
	speed: 0.0292s/iter; left time: 35.0483s
Epoch: 1 cost time: 3.8040285110473633
Epoch: 1, Steps: 130 Train Loss: 3.8130 (Forecasting Loss:0.4711 + AutoCon Loss:3.3419 x Lambda(1.0)), Vali MSE Loss: 1.0825 Test MSE Loss: 0.4689
Validation loss decreased (inf --> 1.082501).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.7238524
	speed: 0.0303s/iter; left time: 32.4323s
Epoch: 2 cost time: 3.9967737197875977
Epoch: 2, Steps: 130 Train Loss: 3.7328 (Forecasting Loss:0.4332 + AutoCon Loss:3.2996 x Lambda(1.0)), Vali MSE Loss: 1.0017 Test MSE Loss: 0.4565
Validation loss decreased (1.082501 --> 1.001705).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.6943164
	speed: 0.0304s/iter; left time: 28.6042s
Epoch: 3 cost time: 3.966632604598999
Epoch: 3, Steps: 130 Train Loss: 3.6867 (Forecasting Loss:0.4253 + AutoCon Loss:3.2615 x Lambda(1.0)), Vali MSE Loss: 1.0015 Test MSE Loss: 0.4539
Validation loss decreased (1.001705 --> 1.001512).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.6464331
	speed: 0.0307s/iter; left time: 24.8909s
Epoch: 4 cost time: 3.9875097274780273
Epoch: 4, Steps: 130 Train Loss: 3.6493 (Forecasting Loss:0.4211 + AutoCon Loss:3.2281 x Lambda(1.0)), Vali MSE Loss: 1.0012 Test MSE Loss: 0.4350
Validation loss decreased (1.001512 --> 1.001169).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.6837549
	speed: 0.0301s/iter; left time: 20.5082s
Epoch: 5 cost time: 3.9200878143310547
Epoch: 5, Steps: 130 Train Loss: 3.6819 (Forecasting Loss:0.4193 + AutoCon Loss:3.2626 x Lambda(1.0)), Vali MSE Loss: 0.9955 Test MSE Loss: 0.4349
Validation loss decreased (1.001169 --> 0.995489).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.7098367
	speed: 0.0300s/iter; left time: 16.5177s
Epoch: 6 cost time: 3.859997272491455
Epoch: 6, Steps: 130 Train Loss: 3.7773 (Forecasting Loss:0.4182 + AutoCon Loss:3.3591 x Lambda(1.0)), Vali MSE Loss: 1.0015 Test MSE Loss: 0.4344
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.8807490
	speed: 0.0299s/iter; left time: 12.5732s
Epoch: 7 cost time: 3.8354339599609375
Epoch: 7, Steps: 130 Train Loss: 3.7629 (Forecasting Loss:0.4179 + AutoCon Loss:3.3450 x Lambda(1.0)), Vali MSE Loss: 0.9972 Test MSE Loss: 0.4342
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.7059884
	speed: 0.0305s/iter; left time: 8.8811s
Epoch: 8 cost time: 4.005765438079834
Epoch: 8, Steps: 130 Train Loss: 3.7405 (Forecasting Loss:0.4172 + AutoCon Loss:3.3233 x Lambda(1.0)), Vali MSE Loss: 0.9989 Test MSE Loss: 0.4330
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl192_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (42, 64, 192, 7) (42, 64, 192, 7)
test shape: (2688, 192, 7) (2688, 192, 7)
mse:0.434918612241745, mae:0.42253464460372925, mape:9.59306812286377, mspe:40071.37890625 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:41057
train 8353
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0467
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl192_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 3.7446337
	speed: 0.0384s/iter; left time: 46.1018s
Epoch: 1 cost time: 4.722028732299805
Epoch: 1, Steps: 130 Train Loss: 3.7474 (Forecasting Loss:0.4662 + AutoCon Loss:3.2812 x Lambda(1.0)), Vali MSE Loss: 1.0163 Test MSE Loss: 0.4591
Validation loss decreased (inf --> 1.016346).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.7040281
	speed: 0.0309s/iter; left time: 33.0623s
Epoch: 2 cost time: 3.977036237716675
Epoch: 2, Steps: 130 Train Loss: 3.7884 (Forecasting Loss:0.4327 + AutoCon Loss:3.3558 x Lambda(1.0)), Vali MSE Loss: 1.0176 Test MSE Loss: 0.4498
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.7263088
	speed: 0.0308s/iter; left time: 29.0092s
Epoch: 3 cost time: 4.053937673568726
Epoch: 3, Steps: 130 Train Loss: 3.7294 (Forecasting Loss:0.4248 + AutoCon Loss:3.3046 x Lambda(1.0)), Vali MSE Loss: 1.0086 Test MSE Loss: 0.4517
Validation loss decreased (1.016346 --> 1.008598).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.7500606
	speed: 0.0297s/iter; left time: 24.0483s
Epoch: 4 cost time: 3.8854026794433594
Epoch: 4, Steps: 130 Train Loss: 3.7449 (Forecasting Loss:0.4213 + AutoCon Loss:3.3235 x Lambda(1.0)), Vali MSE Loss: 0.9933 Test MSE Loss: 0.4394
Validation loss decreased (1.008598 --> 0.993272).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.8909051
	speed: 0.0299s/iter; left time: 20.3906s
Epoch: 5 cost time: 3.8281548023223877
Epoch: 5, Steps: 130 Train Loss: 3.7604 (Forecasting Loss:0.4196 + AutoCon Loss:3.3408 x Lambda(1.0)), Vali MSE Loss: 0.9926 Test MSE Loss: 0.4394
Validation loss decreased (0.993272 --> 0.992639).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.7596545
	speed: 0.0293s/iter; left time: 16.1299s
Epoch: 6 cost time: 3.8524181842803955
Epoch: 6, Steps: 130 Train Loss: 3.7680 (Forecasting Loss:0.4182 + AutoCon Loss:3.3498 x Lambda(1.0)), Vali MSE Loss: 1.0062 Test MSE Loss: 0.4350
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.7491891
	speed: 0.0299s/iter; left time: 12.6031s
Epoch: 7 cost time: 3.8867008686065674
Epoch: 7, Steps: 130 Train Loss: 3.7704 (Forecasting Loss:0.4172 + AutoCon Loss:3.3532 x Lambda(1.0)), Vali MSE Loss: 1.0067 Test MSE Loss: 0.4342
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.9189816
	speed: 0.0309s/iter; left time: 9.0043s
Epoch: 8 cost time: 4.003791332244873
Epoch: 8, Steps: 130 Train Loss: 3.7604 (Forecasting Loss:0.4174 + AutoCon Loss:3.3430 x Lambda(1.0)), Vali MSE Loss: 1.0020 Test MSE Loss: 0.4343
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl192_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (42, 64, 192, 7) (42, 64, 192, 7)
test shape: (2688, 192, 7) (2688, 192, 7)
mse:0.4393689036369324, mae:0.4257999360561371, mape:9.614480018615723, mspe:39862.375 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:41057
train 8353
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0454
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl192_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 3.7267475
	speed: 0.0310s/iter; left time: 37.1781s
Epoch: 1 cost time: 3.9426825046539307
Epoch: 1, Steps: 130 Train Loss: 3.7940 (Forecasting Loss:0.4663 + AutoCon Loss:3.3278 x Lambda(1.0)), Vali MSE Loss: 1.0664 Test MSE Loss: 0.4561
Validation loss decreased (inf --> 1.066413).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.7283018
	speed: 0.0298s/iter; left time: 31.9277s
Epoch: 2 cost time: 3.8943779468536377
Epoch: 2, Steps: 130 Train Loss: 3.7269 (Forecasting Loss:0.4315 + AutoCon Loss:3.2954 x Lambda(1.0)), Vali MSE Loss: 1.0252 Test MSE Loss: 0.4589
Validation loss decreased (1.066413 --> 1.025188).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.6706269
	speed: 0.0313s/iter; left time: 29.4967s
Epoch: 3 cost time: 4.050321340560913
Epoch: 3, Steps: 130 Train Loss: 3.7296 (Forecasting Loss:0.4257 + AutoCon Loss:3.3039 x Lambda(1.0)), Vali MSE Loss: 1.0271 Test MSE Loss: 0.4431
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.7988868
	speed: 0.0312s/iter; left time: 25.3319s
Epoch: 4 cost time: 4.066938877105713
Epoch: 4, Steps: 130 Train Loss: 3.7604 (Forecasting Loss:0.4219 + AutoCon Loss:3.3385 x Lambda(1.0)), Vali MSE Loss: 1.0056 Test MSE Loss: 0.4374
Validation loss decreased (1.025188 --> 1.005597).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.6826420
	speed: 0.0321s/iter; left time: 21.8458s
Epoch: 5 cost time: 4.152066707611084
Epoch: 5, Steps: 130 Train Loss: 3.7554 (Forecasting Loss:0.4193 + AutoCon Loss:3.3361 x Lambda(1.0)), Vali MSE Loss: 0.9917 Test MSE Loss: 0.4395
Validation loss decreased (1.005597 --> 0.991738).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.6732616
	speed: 0.0308s/iter; left time: 16.9982s
Epoch: 6 cost time: 4.0420544147491455
Epoch: 6, Steps: 130 Train Loss: 3.7436 (Forecasting Loss:0.4183 + AutoCon Loss:3.3252 x Lambda(1.0)), Vali MSE Loss: 0.9926 Test MSE Loss: 0.4375
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.6960032
	speed: 0.0298s/iter; left time: 12.5557s
Epoch: 7 cost time: 3.9552223682403564
Epoch: 7, Steps: 130 Train Loss: 3.7482 (Forecasting Loss:0.4177 + AutoCon Loss:3.3305 x Lambda(1.0)), Vali MSE Loss: 0.9955 Test MSE Loss: 0.4339
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.8024557
	speed: 0.0303s/iter; left time: 8.8068s
Epoch: 8 cost time: 3.916949510574341
Epoch: 8, Steps: 130 Train Loss: 3.7491 (Forecasting Loss:0.4167 + AutoCon Loss:3.3324 x Lambda(1.0)), Vali MSE Loss: 0.9950 Test MSE Loss: 0.4345
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl192_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (42, 64, 192, 7) (42, 64, 192, 7)
test shape: (2688, 192, 7) (2688, 192, 7)
mse:0.439534991979599, mae:0.4267752766609192, mape:9.676886558532715, mspe:40160.6171875 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:41057
train 8353
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0511
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl192_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
	iters: 100, epoch: 1 | loss: 3.7467928
	speed: 0.0326s/iter; left time: 39.1460s
Epoch: 1 cost time: 4.256048202514648
Epoch: 1, Steps: 130 Train Loss: 3.7945 (Forecasting Loss:0.4748 + AutoCon Loss:3.3197 x Lambda(1.0)), Vali MSE Loss: 1.0090 Test MSE Loss: 0.4633
Validation loss decreased (inf --> 1.008980).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.8356519
	speed: 0.0299s/iter; left time: 32.0524s
Epoch: 2 cost time: 3.8919858932495117
Epoch: 2, Steps: 130 Train Loss: 3.7506 (Forecasting Loss:0.4329 + AutoCon Loss:3.3178 x Lambda(1.0)), Vali MSE Loss: 1.0150 Test MSE Loss: 0.4506
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.7362142
	speed: 0.0303s/iter; left time: 28.4791s
Epoch: 3 cost time: 3.946773052215576
Epoch: 3, Steps: 130 Train Loss: 3.7618 (Forecasting Loss:0.4247 + AutoCon Loss:3.3371 x Lambda(1.0)), Vali MSE Loss: 0.9956 Test MSE Loss: 0.4512
Validation loss decreased (1.008980 --> 0.995577).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.7846072
	speed: 0.0315s/iter; left time: 25.5163s
Epoch: 4 cost time: 4.130155324935913
Epoch: 4, Steps: 130 Train Loss: 3.7741 (Forecasting Loss:0.4212 + AutoCon Loss:3.3529 x Lambda(1.0)), Vali MSE Loss: 1.0063 Test MSE Loss: 0.4362
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.6446533
	speed: 0.0302s/iter; left time: 20.5982s
Epoch: 5 cost time: 3.99299955368042
Epoch: 5, Steps: 130 Train Loss: 3.7633 (Forecasting Loss:0.4187 + AutoCon Loss:3.3446 x Lambda(1.0)), Vali MSE Loss: 0.9990 Test MSE Loss: 0.4348
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.6577501
	speed: 0.0304s/iter; left time: 16.7779s
Epoch: 6 cost time: 4.049374103546143
Epoch: 6, Steps: 130 Train Loss: 3.7554 (Forecasting Loss:0.4176 + AutoCon Loss:3.3378 x Lambda(1.0)), Vali MSE Loss: 0.9945 Test MSE Loss: 0.4353
Validation loss decreased (0.995577 --> 0.994501).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.6868644
	speed: 0.0302s/iter; left time: 12.6947s
Epoch: 7 cost time: 3.918766498565674
Epoch: 7, Steps: 130 Train Loss: 3.7746 (Forecasting Loss:0.4168 + AutoCon Loss:3.3578 x Lambda(1.0)), Vali MSE Loss: 0.9948 Test MSE Loss: 0.4358
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.6619508
	speed: 0.0307s/iter; left time: 8.9433s
Epoch: 8 cost time: 3.965498685836792
Epoch: 8, Steps: 130 Train Loss: 3.7685 (Forecasting Loss:0.4165 + AutoCon Loss:3.3520 x Lambda(1.0)), Vali MSE Loss: 0.9940 Test MSE Loss: 0.4356
Validation loss decreased (0.994501 --> 0.994024).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.7952740
	speed: 0.0315s/iter; left time: 5.0654s
Epoch: 9 cost time: 4.058960199356079
Epoch: 9, Steps: 130 Train Loss: 3.7660 (Forecasting Loss:0.4161 + AutoCon Loss:3.3499 x Lambda(1.0)), Vali MSE Loss: 0.9936 Test MSE Loss: 0.4354
Validation loss decreased (0.994024 --> 0.993638).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 3.7437854
	speed: 0.0313s/iter; left time: 0.9710s
Epoch: 10 cost time: 4.124695539474487
Epoch: 10, Steps: 130 Train Loss: 3.7721 (Forecasting Loss:0.4163 + AutoCon Loss:3.3558 x Lambda(1.0)), Vali MSE Loss: 0.9958 Test MSE Loss: 0.4349
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-05
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl192_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
test shape: (42, 64, 192, 7) (42, 64, 192, 7)
test shape: (2688, 192, 7) (2688, 192, 7)
mse:0.4353886544704437, mae:0.42252397537231445, mape:9.37017822265625, mspe:38437.8125 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.4369+-0.00286, MAE:0.4240+-0.00259, MAPE:9.5662+-0.14405, MSPE:39722.4180+-902.10861, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(AutoCon=True, AutoCon_lambda=1.0, AutoCon_multiscales=[336], AutoCon_wnorm='LastVal', activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=7, checkpoints='./checkpoints/', d_ff=16, d_layers=1, d_model=16, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=1, embed='timeF', enc_in=7, factor=1, features='M', freq='h', gpu=0, is_training=1, itr=5, label_len=48, learning_rate=0.01, loss='MSE', lradj='type1', mask_rate=0.25, model='AutoConCI', model_id='ICLR24_CRV', moving_avg=25, n_heads=8, num_kernels=6, num_workers=2, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='./dataset/ETT-small', save=False, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_ratio=0.6, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:68993
train 8209
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.1400
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl336_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 3.7779145
	speed: 0.0343s/iter; left time: 40.5135s
Epoch: 1 cost time: 4.34575080871582
Epoch: 1, Steps: 128 Train Loss: 3.8018 (Forecasting Loss:0.5264 + AutoCon Loss:3.2754 x Lambda(1.0)), Vali MSE Loss: 1.3055 Test MSE Loss: 0.5105
Validation loss decreased (inf --> 1.305513).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.8327453
	speed: 0.0335s/iter; left time: 35.3179s
Epoch: 2 cost time: 4.349540948867798
Epoch: 2, Steps: 128 Train Loss: 3.8712 (Forecasting Loss:0.4979 + AutoCon Loss:3.3733 x Lambda(1.0)), Vali MSE Loss: 1.3030 Test MSE Loss: 0.5011
Validation loss decreased (1.305513 --> 1.303007).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.8406491
	speed: 0.0363s/iter; left time: 33.5853s
Epoch: 3 cost time: 4.571736097335815
Epoch: 3, Steps: 128 Train Loss: 3.8141 (Forecasting Loss:0.4897 + AutoCon Loss:3.3244 x Lambda(1.0)), Vali MSE Loss: 1.3137 Test MSE Loss: 0.4858
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.8493607
	speed: 0.0340s/iter; left time: 27.0591s
Epoch: 4 cost time: 4.354057550430298
Epoch: 4, Steps: 128 Train Loss: 3.7786 (Forecasting Loss:0.4836 + AutoCon Loss:3.2951 x Lambda(1.0)), Vali MSE Loss: 1.2926 Test MSE Loss: 0.4771
Validation loss decreased (1.303007 --> 1.292648).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.7461519
	speed: 0.0353s/iter; left time: 23.5980s
Epoch: 5 cost time: 4.525639772415161
Epoch: 5, Steps: 128 Train Loss: 3.7784 (Forecasting Loss:0.4815 + AutoCon Loss:3.2968 x Lambda(1.0)), Vali MSE Loss: 1.2905 Test MSE Loss: 0.4781
Validation loss decreased (1.292648 --> 1.290514).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.8196871
	speed: 0.0336s/iter; left time: 18.1531s
Epoch: 6 cost time: 4.27983546257019
Epoch: 6, Steps: 128 Train Loss: 3.7851 (Forecasting Loss:0.4804 + AutoCon Loss:3.3047 x Lambda(1.0)), Vali MSE Loss: 1.2817 Test MSE Loss: 0.4758
Validation loss decreased (1.290514 --> 1.281750).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.8280575
	speed: 0.0346s/iter; left time: 14.3084s
Epoch: 7 cost time: 4.390725374221802
Epoch: 7, Steps: 128 Train Loss: 3.7889 (Forecasting Loss:0.4798 + AutoCon Loss:3.3091 x Lambda(1.0)), Vali MSE Loss: 1.2868 Test MSE Loss: 0.4744
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.6900809
	speed: 0.0352s/iter; left time: 10.0422s
Epoch: 8 cost time: 4.472302675247192
Epoch: 8, Steps: 128 Train Loss: 3.7803 (Forecasting Loss:0.4791 + AutoCon Loss:3.3011 x Lambda(1.0)), Vali MSE Loss: 1.2849 Test MSE Loss: 0.4747
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.8108754
	speed: 0.0337s/iter; left time: 5.2842s
Epoch: 9 cost time: 4.29987096786499
Epoch: 9, Steps: 128 Train Loss: 3.7817 (Forecasting Loss:0.4790 + AutoCon Loss:3.3027 x Lambda(1.0)), Vali MSE Loss: 1.2846 Test MSE Loss: 0.4741
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl336_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (39, 64, 336, 7) (39, 64, 336, 7)
test shape: (2496, 336, 7) (2496, 336, 7)
mse:0.47582632303237915, mae:0.44266459345817566, mape:9.054594039916992, mspe:38312.1484375 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:68993
train 8209
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0499
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl336_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 3.6731014
	speed: 0.0361s/iter; left time: 42.5832s
Epoch: 1 cost time: 4.6257030963897705
Epoch: 1, Steps: 128 Train Loss: 3.8025 (Forecasting Loss:0.5243 + AutoCon Loss:3.2782 x Lambda(1.0)), Vali MSE Loss: 1.3114 Test MSE Loss: 0.5168
Validation loss decreased (inf --> 1.311427).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 4.1235919
	speed: 0.0343s/iter; left time: 36.1021s
Epoch: 2 cost time: 4.364183187484741
Epoch: 2, Steps: 128 Train Loss: 3.8652 (Forecasting Loss:0.4977 + AutoCon Loss:3.3675 x Lambda(1.0)), Vali MSE Loss: 1.3227 Test MSE Loss: 0.4905
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.8145070
	speed: 0.0355s/iter; left time: 32.8704s
Epoch: 3 cost time: 4.505388975143433
Epoch: 3, Steps: 128 Train Loss: 3.9013 (Forecasting Loss:0.4879 + AutoCon Loss:3.4134 x Lambda(1.0)), Vali MSE Loss: 1.3027 Test MSE Loss: 0.4847
Validation loss decreased (1.311427 --> 1.302722).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.8801596
	speed: 0.0339s/iter; left time: 26.9853s
Epoch: 4 cost time: 4.276275157928467
Epoch: 4, Steps: 128 Train Loss: 3.9317 (Forecasting Loss:0.4834 + AutoCon Loss:3.4483 x Lambda(1.0)), Vali MSE Loss: 1.2918 Test MSE Loss: 0.4778
Validation loss decreased (1.302722 --> 1.291832).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.9511557
	speed: 0.0328s/iter; left time: 21.9536s
Epoch: 5 cost time: 4.185864210128784
Epoch: 5, Steps: 128 Train Loss: 3.9282 (Forecasting Loss:0.4811 + AutoCon Loss:3.4471 x Lambda(1.0)), Vali MSE Loss: 1.2977 Test MSE Loss: 0.4758
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.9079814
	speed: 0.0330s/iter; left time: 17.8682s
Epoch: 6 cost time: 4.266700744628906
Epoch: 6, Steps: 128 Train Loss: 3.9096 (Forecasting Loss:0.4797 + AutoCon Loss:3.4299 x Lambda(1.0)), Vali MSE Loss: 1.2873 Test MSE Loss: 0.4767
Validation loss decreased (1.291832 --> 1.287341).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.8224435
	speed: 0.0341s/iter; left time: 14.0943s
Epoch: 7 cost time: 4.304620027542114
Epoch: 7, Steps: 128 Train Loss: 3.8972 (Forecasting Loss:0.4791 + AutoCon Loss:3.4181 x Lambda(1.0)), Vali MSE Loss: 1.2959 Test MSE Loss: 0.4750
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 4.0792356
	speed: 0.0330s/iter; left time: 9.3971s
Epoch: 8 cost time: 4.184325456619263
Epoch: 8, Steps: 128 Train Loss: 3.9217 (Forecasting Loss:0.4789 + AutoCon Loss:3.4428 x Lambda(1.0)), Vali MSE Loss: 1.2888 Test MSE Loss: 0.4757
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.9914942
	speed: 0.0332s/iter; left time: 5.2115s
Epoch: 9 cost time: 4.264619827270508
Epoch: 9, Steps: 128 Train Loss: 3.9219 (Forecasting Loss:0.4788 + AutoCon Loss:3.4431 x Lambda(1.0)), Vali MSE Loss: 1.2916 Test MSE Loss: 0.4750
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl336_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (39, 64, 336, 7) (39, 64, 336, 7)
test shape: (2496, 336, 7) (2496, 336, 7)
mse:0.47674915194511414, mae:0.44223013520240784, mape:9.058603286743164, mspe:38140.65234375 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:68993
train 8209
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0476
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl336_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 3.7179766
	speed: 0.0332s/iter; left time: 39.2372s
Epoch: 1 cost time: 4.237633228302002
Epoch: 1, Steps: 128 Train Loss: 3.8332 (Forecasting Loss:0.5373 + AutoCon Loss:3.2959 x Lambda(1.0)), Vali MSE Loss: 1.3268 Test MSE Loss: 0.4926
Validation loss decreased (inf --> 1.326779).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.8396833
	speed: 0.0342s/iter; left time: 36.0069s
Epoch: 2 cost time: 4.7791924476623535
Epoch: 2, Steps: 128 Train Loss: 3.8088 (Forecasting Loss:0.4966 + AutoCon Loss:3.3122 x Lambda(1.0)), Vali MSE Loss: 1.3061 Test MSE Loss: 0.4910
Validation loss decreased (1.326779 --> 1.306102).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.8821948
	speed: 0.0358s/iter; left time: 33.1565s
Epoch: 3 cost time: 5.603042840957642
Epoch: 3, Steps: 128 Train Loss: 3.7593 (Forecasting Loss:0.4871 + AutoCon Loss:3.2721 x Lambda(1.0)), Vali MSE Loss: 1.2964 Test MSE Loss: 0.4821
Validation loss decreased (1.306102 --> 1.296416).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.7416089
	speed: 0.0378s/iter; left time: 30.1121s
Epoch: 4 cost time: 4.814075231552124
Epoch: 4, Steps: 128 Train Loss: 3.6988 (Forecasting Loss:0.4839 + AutoCon Loss:3.2149 x Lambda(1.0)), Vali MSE Loss: 1.2879 Test MSE Loss: 0.4784
Validation loss decreased (1.296416 --> 1.287881).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.6892669
	speed: 0.0361s/iter; left time: 24.1191s
Epoch: 5 cost time: 4.612641096115112
Epoch: 5, Steps: 128 Train Loss: 3.6942 (Forecasting Loss:0.4821 + AutoCon Loss:3.2121 x Lambda(1.0)), Vali MSE Loss: 1.2939 Test MSE Loss: 0.4774
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.7105155
	speed: 0.0361s/iter; left time: 19.5221s
Epoch: 6 cost time: 4.583254098892212
Epoch: 6, Steps: 128 Train Loss: 3.6960 (Forecasting Loss:0.4807 + AutoCon Loss:3.2153 x Lambda(1.0)), Vali MSE Loss: 1.2902 Test MSE Loss: 0.4758
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.8129189
	speed: 0.0369s/iter; left time: 15.2268s
Epoch: 7 cost time: 4.713399648666382
Epoch: 7, Steps: 128 Train Loss: 3.7284 (Forecasting Loss:0.4806 + AutoCon Loss:3.2478 x Lambda(1.0)), Vali MSE Loss: 1.2870 Test MSE Loss: 0.4766
Validation loss decreased (1.287881 --> 1.287000).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.7888110
	speed: 0.0364s/iter; left time: 10.3880s
Epoch: 8 cost time: 4.6594672203063965
Epoch: 8, Steps: 128 Train Loss: 3.7549 (Forecasting Loss:0.4803 + AutoCon Loss:3.2746 x Lambda(1.0)), Vali MSE Loss: 1.2904 Test MSE Loss: 0.4757
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.7821031
	speed: 0.0358s/iter; left time: 5.6157s
Epoch: 9 cost time: 4.594877243041992
Epoch: 9, Steps: 128 Train Loss: 3.7711 (Forecasting Loss:0.4801 + AutoCon Loss:3.2910 x Lambda(1.0)), Vali MSE Loss: 1.2923 Test MSE Loss: 0.4754
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 3.7775128
	speed: 0.0361s/iter; left time: 1.0480s
Epoch: 10 cost time: 4.625863790512085
Epoch: 10, Steps: 128 Train Loss: 3.7853 (Forecasting Loss:0.4799 + AutoCon Loss:3.3054 x Lambda(1.0)), Vali MSE Loss: 1.2875 Test MSE Loss: 0.4759
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl336_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (39, 64, 336, 7) (39, 64, 336, 7)
test shape: (2496, 336, 7) (2496, 336, 7)
mse:0.47663798928260803, mae:0.4427282512187958, mape:9.091612815856934, mspe:38336.14453125 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:68993
train 8209
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0476
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl336_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 3.7148337
	speed: 0.0325s/iter; left time: 38.3989s
Epoch: 1 cost time: 4.175522804260254
Epoch: 1, Steps: 128 Train Loss: 3.8406 (Forecasting Loss:0.5290 + AutoCon Loss:3.3117 x Lambda(1.0)), Vali MSE Loss: 1.3110 Test MSE Loss: 0.4939
Validation loss decreased (inf --> 1.311000).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.7087586
	speed: 0.0414s/iter; left time: 43.6329s
Epoch: 2 cost time: 5.150391578674316
Epoch: 2, Steps: 128 Train Loss: 3.8078 (Forecasting Loss:0.4959 + AutoCon Loss:3.3119 x Lambda(1.0)), Vali MSE Loss: 1.3252 Test MSE Loss: 0.4967
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.8129759
	speed: 0.0328s/iter; left time: 30.3282s
Epoch: 3 cost time: 4.2165117263793945
Epoch: 3, Steps: 128 Train Loss: 3.7808 (Forecasting Loss:0.4879 + AutoCon Loss:3.2929 x Lambda(1.0)), Vali MSE Loss: 1.3149 Test MSE Loss: 0.4828
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.9186234
	speed: 0.0334s/iter; left time: 26.6192s
Epoch: 4 cost time: 4.583702564239502
Epoch: 4, Steps: 128 Train Loss: 3.7743 (Forecasting Loss:0.4837 + AutoCon Loss:3.2906 x Lambda(1.0)), Vali MSE Loss: 1.2951 Test MSE Loss: 0.4804
Validation loss decreased (1.311000 --> 1.295093).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.7949924
	speed: 0.0344s/iter; left time: 22.9807s
Epoch: 5 cost time: 4.500386953353882
Epoch: 5, Steps: 128 Train Loss: 3.7995 (Forecasting Loss:0.4815 + AutoCon Loss:3.3180 x Lambda(1.0)), Vali MSE Loss: 1.2921 Test MSE Loss: 0.4784
Validation loss decreased (1.295093 --> 1.292103).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 4.0142698
	speed: 0.0347s/iter; left time: 18.7877s
Epoch: 6 cost time: 4.34140157699585
Epoch: 6, Steps: 128 Train Loss: 3.7798 (Forecasting Loss:0.4807 + AutoCon Loss:3.2991 x Lambda(1.0)), Vali MSE Loss: 1.2857 Test MSE Loss: 0.4753
Validation loss decreased (1.292103 --> 1.285711).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.8725998
	speed: 0.0328s/iter; left time: 13.5421s
Epoch: 7 cost time: 4.153632402420044
Epoch: 7, Steps: 128 Train Loss: 3.7747 (Forecasting Loss:0.4797 + AutoCon Loss:3.2950 x Lambda(1.0)), Vali MSE Loss: 1.2880 Test MSE Loss: 0.4740
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.7023940
	speed: 0.0333s/iter; left time: 9.5037s
Epoch: 8 cost time: 4.259523153305054
Epoch: 8, Steps: 128 Train Loss: 3.7706 (Forecasting Loss:0.4796 + AutoCon Loss:3.2910 x Lambda(1.0)), Vali MSE Loss: 1.2886 Test MSE Loss: 0.4747
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.8302245
	speed: 0.0336s/iter; left time: 5.2758s
Epoch: 9 cost time: 4.2427074909210205
Epoch: 9, Steps: 128 Train Loss: 3.7815 (Forecasting Loss:0.4794 + AutoCon Loss:3.3022 x Lambda(1.0)), Vali MSE Loss: 1.2860 Test MSE Loss: 0.4742
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl336_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (39, 64, 336, 7) (39, 64, 336, 7)
test shape: (2496, 336, 7) (2496, 336, 7)
mse:0.47531798481941223, mae:0.4422008991241455, mape:9.0429048538208, mspe:38064.265625 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:68993
train 8209
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0452
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl336_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 3.7171686
	speed: 0.0334s/iter; left time: 39.3884s
Epoch: 1 cost time: 4.209820747375488
Epoch: 1, Steps: 128 Train Loss: 3.8209 (Forecasting Loss:0.5334 + AutoCon Loss:3.2875 x Lambda(1.0)), Vali MSE Loss: 1.3108 Test MSE Loss: 0.4973
Validation loss decreased (inf --> 1.310796).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.8608646
	speed: 0.0335s/iter; left time: 35.3136s
Epoch: 2 cost time: 4.316624641418457
Epoch: 2, Steps: 128 Train Loss: 3.8356 (Forecasting Loss:0.4951 + AutoCon Loss:3.3405 x Lambda(1.0)), Vali MSE Loss: 1.3078 Test MSE Loss: 0.5107
Validation loss decreased (1.310796 --> 1.307809).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.7621098
	speed: 0.0336s/iter; left time: 31.0544s
Epoch: 3 cost time: 4.28366231918335
Epoch: 3, Steps: 128 Train Loss: 3.7857 (Forecasting Loss:0.4898 + AutoCon Loss:3.2959 x Lambda(1.0)), Vali MSE Loss: 1.2975 Test MSE Loss: 0.4854
Validation loss decreased (1.307809 --> 1.297541).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.7605245
	speed: 0.0327s/iter; left time: 26.0227s
Epoch: 4 cost time: 4.19153618812561
Epoch: 4, Steps: 128 Train Loss: 3.7824 (Forecasting Loss:0.4834 + AutoCon Loss:3.2990 x Lambda(1.0)), Vali MSE Loss: 1.2982 Test MSE Loss: 0.4800
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.6968424
	speed: 0.0339s/iter; left time: 22.6506s
Epoch: 5 cost time: 4.345658779144287
Epoch: 5, Steps: 128 Train Loss: 3.7703 (Forecasting Loss:0.4822 + AutoCon Loss:3.2881 x Lambda(1.0)), Vali MSE Loss: 1.2915 Test MSE Loss: 0.4766
Validation loss decreased (1.297541 --> 1.291489).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.6617579
	speed: 0.0340s/iter; left time: 18.3969s
Epoch: 6 cost time: 4.324228286743164
Epoch: 6, Steps: 128 Train Loss: 3.7576 (Forecasting Loss:0.4805 + AutoCon Loss:3.2772 x Lambda(1.0)), Vali MSE Loss: 1.2898 Test MSE Loss: 0.4750
Validation loss decreased (1.291489 --> 1.289844).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.6842775
	speed: 0.0340s/iter; left time: 14.0418s
Epoch: 7 cost time: 4.35319185256958
Epoch: 7, Steps: 128 Train Loss: 3.7757 (Forecasting Loss:0.4800 + AutoCon Loss:3.2956 x Lambda(1.0)), Vali MSE Loss: 1.2886 Test MSE Loss: 0.4752
Validation loss decreased (1.289844 --> 1.288625).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.7930980
	speed: 0.0346s/iter; left time: 9.8643s
Epoch: 8 cost time: 4.523626327514648
Epoch: 8, Steps: 128 Train Loss: 3.7709 (Forecasting Loss:0.4796 + AutoCon Loss:3.2912 x Lambda(1.0)), Vali MSE Loss: 1.2899 Test MSE Loss: 0.4749
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.8136003
	speed: 0.0335s/iter; left time: 5.2593s
Epoch: 9 cost time: 4.260408163070679
Epoch: 9, Steps: 128 Train Loss: 3.7666 (Forecasting Loss:0.4794 + AutoCon Loss:3.2872 x Lambda(1.0)), Vali MSE Loss: 1.2866 Test MSE Loss: 0.4753
Validation loss decreased (1.288625 --> 1.286580).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 3.6837626
	speed: 0.0348s/iter; left time: 1.0106s
Epoch: 10 cost time: 4.678423643112183
Epoch: 10, Steps: 128 Train Loss: 3.7648 (Forecasting Loss:0.4791 + AutoCon Loss:3.2857 x Lambda(1.0)), Vali MSE Loss: 1.2863 Test MSE Loss: 0.4752
Validation loss decreased (1.286580 --> 1.286280).  Saving model ...
Updating learning rate to 1.953125e-05
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl336_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
test shape: (39, 64, 336, 7) (39, 64, 336, 7)
test shape: (2496, 336, 7) (2496, 336, 7)
mse:0.47522076964378357, mae:0.44158387184143066, mape:9.076615333557129, mspe:38168.078125 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.4760+-0.00089, MAE:0.4423+-0.00057, MAPE:9.0649+-0.02389, MSPE:38204.2578+-144.25086, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000
Args in experiment:
Namespace(AutoCon=True, AutoCon_lambda=1.0, AutoCon_multiscales=[720], AutoCon_wnorm='LastVal', activation='gelu', anomaly_ratio=0.25, batch_size=64, c_out=7, checkpoints='./checkpoints/', d_ff=16, d_layers=1, d_model=16, data='ETTh1', data_path='ETTh1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=1, embed='timeF', enc_in=7, factor=1, features='M', freq='h', gpu=0, is_training=1, itr=5, label_len=48, learning_rate=0.01, loss='MSE', lradj='type1', mask_rate=0.25, model='AutoConCI', model_id='ICLR24_CRV', moving_avg=25, n_heads=8, num_kernels=6, num_workers=2, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='./dataset/ETT-small', save=False, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_ratio=0.6, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:143489
train 7825
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.1423
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl720_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 3.9984114
	speed: 0.0489s/iter; left time: 54.8185s
Epoch: 1 cost time: 5.999815940856934
Epoch: 1, Steps: 122 Train Loss: 3.9657 (Forecasting Loss:0.6534 + AutoCon Loss:3.3123 x Lambda(1.0)), Vali MSE Loss: 1.5899 Test MSE Loss: 0.4833
Validation loss decreased (inf --> 1.589908).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.8386540
	speed: 0.0483s/iter; left time: 48.2094s
Epoch: 2 cost time: 5.9062206745147705
Epoch: 2, Steps: 122 Train Loss: 3.9470 (Forecasting Loss:0.6191 + AutoCon Loss:3.3279 x Lambda(1.0)), Vali MSE Loss: 1.5771 Test MSE Loss: 0.4784
Validation loss decreased (1.589908 --> 1.577059).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.8412409
	speed: 0.0484s/iter; left time: 42.4783s
Epoch: 3 cost time: 5.9483537673950195
Epoch: 3, Steps: 122 Train Loss: 3.8884 (Forecasting Loss:0.6115 + AutoCon Loss:3.2769 x Lambda(1.0)), Vali MSE Loss: 1.5676 Test MSE Loss: 0.4865
Validation loss decreased (1.577059 --> 1.567550).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.8367479
	speed: 0.0501s/iter; left time: 37.8546s
Epoch: 4 cost time: 6.106669187545776
Epoch: 4, Steps: 122 Train Loss: 3.8802 (Forecasting Loss:0.6065 + AutoCon Loss:3.2737 x Lambda(1.0)), Vali MSE Loss: 1.5706 Test MSE Loss: 0.4713
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.9175406
	speed: 0.0482s/iter; left time: 30.5388s
Epoch: 5 cost time: 5.960189342498779
Epoch: 5, Steps: 122 Train Loss: 3.9010 (Forecasting Loss:0.6040 + AutoCon Loss:3.2970 x Lambda(1.0)), Vali MSE Loss: 1.5566 Test MSE Loss: 0.4698
Validation loss decreased (1.567550 --> 1.556589).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.9390349
	speed: 0.0483s/iter; left time: 24.6883s
Epoch: 6 cost time: 5.941393136978149
Epoch: 6, Steps: 122 Train Loss: 3.8959 (Forecasting Loss:0.6026 + AutoCon Loss:3.2933 x Lambda(1.0)), Vali MSE Loss: 1.5611 Test MSE Loss: 0.4701
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.8863983
	speed: 0.0477s/iter; left time: 18.5380s
Epoch: 7 cost time: 6.193832159042358
Epoch: 7, Steps: 122 Train Loss: 3.8940 (Forecasting Loss:0.6020 + AutoCon Loss:3.2920 x Lambda(1.0)), Vali MSE Loss: 1.5576 Test MSE Loss: 0.4686
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.9050026
	speed: 0.0487s/iter; left time: 12.9976s
Epoch: 8 cost time: 6.238545656204224
Epoch: 8, Steps: 122 Train Loss: 3.8946 (Forecasting Loss:0.6013 + AutoCon Loss:3.2933 x Lambda(1.0)), Vali MSE Loss: 1.5581 Test MSE Loss: 0.4687
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl720_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (33, 64, 720, 7) (33, 64, 720, 7)
test shape: (2112, 720, 7) (2112, 720, 7)
mse:0.46977442502975464, mae:0.46330946683883667, mape:9.490649223327637, mspe:40407.44921875 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:143489
train 7825
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0481
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl720_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 3.8938313
	speed: 0.0513s/iter; left time: 57.5288s
Epoch: 1 cost time: 6.266825199127197
Epoch: 1, Steps: 122 Train Loss: 3.9707 (Forecasting Loss:0.6576 + AutoCon Loss:3.3131 x Lambda(1.0)), Vali MSE Loss: 1.5867 Test MSE Loss: 0.4852
Validation loss decreased (inf --> 1.586702).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.9853706
	speed: 0.0523s/iter; left time: 52.2444s
Epoch: 2 cost time: 6.411123991012573
Epoch: 2, Steps: 122 Train Loss: 4.0567 (Forecasting Loss:0.6180 + AutoCon Loss:3.4387 x Lambda(1.0)), Vali MSE Loss: 1.5806 Test MSE Loss: 0.4885
Validation loss decreased (1.586702 --> 1.580636).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.9152255
	speed: 0.0509s/iter; left time: 44.6799s
Epoch: 3 cost time: 6.27398681640625
Epoch: 3, Steps: 122 Train Loss: 3.9578 (Forecasting Loss:0.6107 + AutoCon Loss:3.3471 x Lambda(1.0)), Vali MSE Loss: 1.5695 Test MSE Loss: 0.4796
Validation loss decreased (1.580636 --> 1.569521).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.9319305
	speed: 0.0517s/iter; left time: 39.0110s
Epoch: 4 cost time: 6.3007752895355225
Epoch: 4, Steps: 122 Train Loss: 3.9518 (Forecasting Loss:0.6065 + AutoCon Loss:3.3452 x Lambda(1.0)), Vali MSE Loss: 1.5613 Test MSE Loss: 0.4711
Validation loss decreased (1.569521 --> 1.561255).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.9522684
	speed: 0.0507s/iter; left time: 32.1096s
Epoch: 5 cost time: 6.228323936462402
Epoch: 5, Steps: 122 Train Loss: 3.9685 (Forecasting Loss:0.6037 + AutoCon Loss:3.3648 x Lambda(1.0)), Vali MSE Loss: 1.5616 Test MSE Loss: 0.4674
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.9294903
	speed: 0.0513s/iter; left time: 26.2055s
Epoch: 6 cost time: 6.2627575397491455
Epoch: 6, Steps: 122 Train Loss: 3.9522 (Forecasting Loss:0.6024 + AutoCon Loss:3.3498 x Lambda(1.0)), Vali MSE Loss: 1.5570 Test MSE Loss: 0.4666
Validation loss decreased (1.561255 --> 1.557026).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.9198992
	speed: 0.0513s/iter; left time: 19.9445s
Epoch: 7 cost time: 6.236902475357056
Epoch: 7, Steps: 122 Train Loss: 3.9537 (Forecasting Loss:0.6015 + AutoCon Loss:3.3522 x Lambda(1.0)), Vali MSE Loss: 1.5538 Test MSE Loss: 0.4677
Validation loss decreased (1.557026 --> 1.553760).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.8530409
	speed: 0.0509s/iter; left time: 13.5924s
Epoch: 8 cost time: 6.224654197692871
Epoch: 8, Steps: 122 Train Loss: 3.9389 (Forecasting Loss:0.6016 + AutoCon Loss:3.3373 x Lambda(1.0)), Vali MSE Loss: 1.5557 Test MSE Loss: 0.4669
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.8700337
	speed: 0.0507s/iter; left time: 7.3497s
Epoch: 9 cost time: 6.2035813331604
Epoch: 9, Steps: 122 Train Loss: 3.9396 (Forecasting Loss:0.6014 + AutoCon Loss:3.3382 x Lambda(1.0)), Vali MSE Loss: 1.5591 Test MSE Loss: 0.4673
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 4.0590849
	speed: 0.0511s/iter; left time: 1.1742s
Epoch: 10 cost time: 6.215877532958984
Epoch: 10, Steps: 122 Train Loss: 3.9332 (Forecasting Loss:0.6010 + AutoCon Loss:3.3322 x Lambda(1.0)), Vali MSE Loss: 1.5575 Test MSE Loss: 0.4672
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl720_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (33, 64, 720, 7) (33, 64, 720, 7)
test shape: (2112, 720, 7) (2112, 720, 7)
mse:0.46774300932884216, mae:0.4624233841896057, mape:9.452520370483398, mspe:40102.34375 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:143489
train 7825
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0497
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl720_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 3.8545227
	speed: 0.0517s/iter; left time: 58.0070s
Epoch: 1 cost time: 6.333104372024536
Epoch: 1, Steps: 122 Train Loss: 3.9936 (Forecasting Loss:0.6578 + AutoCon Loss:3.3358 x Lambda(1.0)), Vali MSE Loss: 1.5951 Test MSE Loss: 0.4939
Validation loss decreased (inf --> 1.595056).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 4.1035681
	speed: 0.0574s/iter; left time: 57.3912s
Epoch: 2 cost time: 7.008336544036865
Epoch: 2, Steps: 122 Train Loss: 4.0129 (Forecasting Loss:0.6185 + AutoCon Loss:3.3944 x Lambda(1.0)), Vali MSE Loss: 1.5906 Test MSE Loss: 0.5024
Validation loss decreased (1.595056 --> 1.590560).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 3.8871095
	speed: 0.0551s/iter; left time: 48.3537s
Epoch: 3 cost time: 6.723700523376465
Epoch: 3, Steps: 122 Train Loss: 3.9537 (Forecasting Loss:0.6109 + AutoCon Loss:3.3428 x Lambda(1.0)), Vali MSE Loss: 1.5690 Test MSE Loss: 0.4730
Validation loss decreased (1.590560 --> 1.568971).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 4.0616837
	speed: 0.0567s/iter; left time: 42.7890s
Epoch: 4 cost time: 6.881563663482666
Epoch: 4, Steps: 122 Train Loss: 3.9313 (Forecasting Loss:0.6068 + AutoCon Loss:3.3245 x Lambda(1.0)), Vali MSE Loss: 1.5621 Test MSE Loss: 0.4720
Validation loss decreased (1.568971 --> 1.562116).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.9632301
	speed: 0.0549s/iter; left time: 34.7274s
Epoch: 5 cost time: 6.67007303237915
Epoch: 5, Steps: 122 Train Loss: 3.9406 (Forecasting Loss:0.6043 + AutoCon Loss:3.3363 x Lambda(1.0)), Vali MSE Loss: 1.5647 Test MSE Loss: 0.4690
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.9107475
	speed: 0.0538s/iter; left time: 27.5120s
Epoch: 6 cost time: 6.549361705780029
Epoch: 6, Steps: 122 Train Loss: 3.9431 (Forecasting Loss:0.6028 + AutoCon Loss:3.3403 x Lambda(1.0)), Vali MSE Loss: 1.5639 Test MSE Loss: 0.4652
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 4.0247898
	speed: 0.0534s/iter; left time: 20.7896s
Epoch: 7 cost time: 6.547389268875122
Epoch: 7, Steps: 122 Train Loss: 3.9503 (Forecasting Loss:0.6021 + AutoCon Loss:3.3481 x Lambda(1.0)), Vali MSE Loss: 1.5622 Test MSE Loss: 0.4630
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl720_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (33, 64, 720, 7) (33, 64, 720, 7)
test shape: (2112, 720, 7) (2112, 720, 7)
mse:0.4720139801502228, mae:0.4633514881134033, mape:9.535002708435059, mspe:40708.0625 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:143489
train 7825
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0475
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl720_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 3.8996637
	speed: 0.0478s/iter; left time: 53.5569s
Epoch: 1 cost time: 5.866445064544678
Epoch: 1, Steps: 122 Train Loss: 3.9909 (Forecasting Loss:0.6574 + AutoCon Loss:3.3335 x Lambda(1.0)), Vali MSE Loss: 1.5869 Test MSE Loss: 0.4924
Validation loss decreased (inf --> 1.586895).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 3.9835830
	speed: 0.0495s/iter; left time: 49.4376s
Epoch: 2 cost time: 6.038858890533447
Epoch: 2, Steps: 122 Train Loss: 3.9843 (Forecasting Loss:0.6214 + AutoCon Loss:3.3629 x Lambda(1.0)), Vali MSE Loss: 1.5785 Test MSE Loss: 0.4804
Validation loss decreased (1.586895 --> 1.578485).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 4.0351119
	speed: 0.0541s/iter; left time: 47.4843s
Epoch: 3 cost time: 6.658595561981201
Epoch: 3, Steps: 122 Train Loss: 3.9292 (Forecasting Loss:0.6105 + AutoCon Loss:3.3188 x Lambda(1.0)), Vali MSE Loss: 1.5648 Test MSE Loss: 0.4766
Validation loss decreased (1.578485 --> 1.564828).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.8547940
	speed: 0.0548s/iter; left time: 41.3493s
Epoch: 4 cost time: 6.71338677406311
Epoch: 4, Steps: 122 Train Loss: 3.9327 (Forecasting Loss:0.6072 + AutoCon Loss:3.3255 x Lambda(1.0)), Vali MSE Loss: 1.5661 Test MSE Loss: 0.4655
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.9872885
	speed: 0.0544s/iter; left time: 34.4277s
Epoch: 5 cost time: 6.639828443527222
Epoch: 5, Steps: 122 Train Loss: 3.9391 (Forecasting Loss:0.6044 + AutoCon Loss:3.3346 x Lambda(1.0)), Vali MSE Loss: 1.5650 Test MSE Loss: 0.4653
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.9562354
	speed: 0.0549s/iter; left time: 28.0656s
Epoch: 6 cost time: 6.708566665649414
Epoch: 6, Steps: 122 Train Loss: 3.9399 (Forecasting Loss:0.6031 + AutoCon Loss:3.3367 x Lambda(1.0)), Vali MSE Loss: 1.5609 Test MSE Loss: 0.4651
Validation loss decreased (1.564828 --> 1.560868).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.9711602
	speed: 0.0535s/iter; left time: 20.8013s
Epoch: 7 cost time: 6.573484659194946
Epoch: 7, Steps: 122 Train Loss: 3.9464 (Forecasting Loss:0.6023 + AutoCon Loss:3.3441 x Lambda(1.0)), Vali MSE Loss: 1.5565 Test MSE Loss: 0.4646
Validation loss decreased (1.560868 --> 1.556545).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.9820137
	speed: 0.0555s/iter; left time: 14.8176s
Epoch: 8 cost time: 6.849049806594849
Epoch: 8, Steps: 122 Train Loss: 3.9412 (Forecasting Loss:0.6019 + AutoCon Loss:3.3394 x Lambda(1.0)), Vali MSE Loss: 1.5579 Test MSE Loss: 0.4642
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.9384401
	speed: 0.0545s/iter; left time: 7.9006s
Epoch: 9 cost time: 6.625201463699341
Epoch: 9, Steps: 122 Train Loss: 3.9452 (Forecasting Loss:0.6019 + AutoCon Loss:3.3433 x Lambda(1.0)), Vali MSE Loss: 1.5585 Test MSE Loss: 0.4642
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 3.9833422
	speed: 0.0546s/iter; left time: 1.2557s
Epoch: 10 cost time: 6.6528239250183105
Epoch: 10, Steps: 122 Train Loss: 3.9423 (Forecasting Loss:0.6015 + AutoCon Loss:3.3408 x Lambda(1.0)), Vali MSE Loss: 1.5553 Test MSE Loss: 0.4645
Validation loss decreased (1.556545 --> 1.555346).  Saving model ...
Updating learning rate to 1.953125e-05
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl720_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (33, 64, 720, 7) (33, 64, 720, 7)
test shape: (2112, 720, 7) (2112, 720, 7)
mse:0.4645020663738251, mae:0.4587734341621399, mape:9.5061616897583, mspe:41011.8359375 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
Use GPU: cuda:0
TimeFeatureEmbedding-wo-freq:   []
model parameters:143489
train 7825
Auto-correlation values(abs):[1.         0.99988107] ~ [-7.30835967e-06 -3.95024283e-06]
Autocorrelation calculation time: 0.0472
>>>>>>>start training : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl720_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 4.1671576
	speed: 0.0505s/iter; left time: 56.6136s
Epoch: 1 cost time: 6.247189283370972
Epoch: 1, Steps: 122 Train Loss: 3.9947 (Forecasting Loss:0.6599 + AutoCon Loss:3.3348 x Lambda(1.0)), Vali MSE Loss: 1.5838 Test MSE Loss: 0.4838
Validation loss decreased (inf --> 1.583822).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 4.0496149
	speed: 0.0535s/iter; left time: 53.4445s
Epoch: 2 cost time: 6.544413328170776
Epoch: 2, Steps: 122 Train Loss: 4.0216 (Forecasting Loss:0.6185 + AutoCon Loss:3.4031 x Lambda(1.0)), Vali MSE Loss: 1.5850 Test MSE Loss: 0.4842
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 4.0124073
	speed: 0.0541s/iter; left time: 47.4656s
Epoch: 3 cost time: 6.594400405883789
Epoch: 3, Steps: 122 Train Loss: 3.9494 (Forecasting Loss:0.6108 + AutoCon Loss:3.3386 x Lambda(1.0)), Vali MSE Loss: 1.5741 Test MSE Loss: 0.4824
Validation loss decreased (1.583822 --> 1.574061).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 3.8867416
	speed: 0.0504s/iter; left time: 38.0751s
Epoch: 4 cost time: 6.304638147354126
Epoch: 4, Steps: 122 Train Loss: 3.9393 (Forecasting Loss:0.6067 + AutoCon Loss:3.3327 x Lambda(1.0)), Vali MSE Loss: 1.5642 Test MSE Loss: 0.4654
Validation loss decreased (1.574061 --> 1.564153).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 3.9378750
	speed: 0.0502s/iter; left time: 31.8017s
Epoch: 5 cost time: 6.1547935009002686
Epoch: 5, Steps: 122 Train Loss: 3.9459 (Forecasting Loss:0.6042 + AutoCon Loss:3.3417 x Lambda(1.0)), Vali MSE Loss: 1.5597 Test MSE Loss: 0.4656
Validation loss decreased (1.564153 --> 1.559730).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 3.9721599
	speed: 0.0490s/iter; left time: 25.0434s
Epoch: 6 cost time: 5.989974737167358
Epoch: 6, Steps: 122 Train Loss: 3.9448 (Forecasting Loss:0.6027 + AutoCon Loss:3.3421 x Lambda(1.0)), Vali MSE Loss: 1.5576 Test MSE Loss: 0.4656
Validation loss decreased (1.559730 --> 1.557579).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 3.9610353
	speed: 0.0496s/iter; left time: 19.2763s
Epoch: 7 cost time: 6.04198694229126
Epoch: 7, Steps: 122 Train Loss: 3.9461 (Forecasting Loss:0.6025 + AutoCon Loss:3.3437 x Lambda(1.0)), Vali MSE Loss: 1.5596 Test MSE Loss: 0.4637
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 3.9666686
	speed: 0.0483s/iter; left time: 12.8978s
Epoch: 8 cost time: 5.983643531799316
Epoch: 8, Steps: 122 Train Loss: 3.9443 (Forecasting Loss:0.6021 + AutoCon Loss:3.3422 x Lambda(1.0)), Vali MSE Loss: 1.5615 Test MSE Loss: 0.4648
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 3.9163275
	speed: 0.0505s/iter; left time: 7.3186s
Epoch: 9 cost time: 6.165501117706299
Epoch: 9, Steps: 122 Train Loss: 3.9462 (Forecasting Loss:0.6016 + AutoCon Loss:3.3446 x Lambda(1.0)), Vali MSE Loss: 1.5559 Test MSE Loss: 0.4648
Validation loss decreased (1.557579 --> 1.555913).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 3.9156897
	speed: 0.0486s/iter; left time: 1.1167s
Epoch: 10 cost time: 5.934853553771973
Epoch: 10, Steps: 122 Train Loss: 3.9519 (Forecasting Loss:0.6015 + AutoCon Loss:3.3504 x Lambda(1.0)), Vali MSE Loss: 1.5550 Test MSE Loss: 0.4642
Validation loss decreased (1.555913 --> 1.554992).  Saving model ...
Updating learning rate to 1.953125e-05
>>>>>>>testing : long_term_forecast_ICLR24_CRV_AutoConCI_ETTh1_ftM_sl96_ll48_pl720_dm16_nh8_el1_dl1_df16_fc1_ebtimeF_dtTrue_Exp_4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (33, 64, 720, 7) (33, 64, 720, 7)
test shape: (2112, 720, 7) (2112, 720, 7)
mse:0.46419915556907654, mae:0.45882654190063477, mape:9.450116157531738, mspe:40620.51953125 dilate:0.0000000, Shapedtw:0.0000000, Temporaldtw:0.0000000
MSE:0.4676+-0.00418, MAE:0.4613+-0.00291, MAPE:9.4869+-0.04491, MSPE:40570.0391+-421.96375, SHAPEDTW:0.0000+-0.00000, TEMPDTW:0.0000+-0.00000